<!DOCTYPE html><html lang="en"><head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç¬¬ 01 è®²ï¼šè®¾è®¡ä¸€ä»½å¸å¼•é¢è¯•å®˜çš„ç®€å†</title>
<style type="text/css">
:root {
    --control-text-color: #777;
    --select-text-bg-color: rgba(223, 197, 223);  /*#7e66992e;*/
    
    /* side bar */
    --side-bar-bg-color: rgb(255, 255, 255);
    --active-file-text-color: #8163bd;
    --active-file-bg-color: #E9E4F0;
    --item-hover-bg-color: #E9E4F0;
    --active-file-border-color: #8163bd;

    --title-color: #6c549c;
    --font-sans-serif: 'Ubuntu', 'Source Sans Pro', sans-serif !important;
    --font-monospace: 'Fira Code', 'Roboto Mono', monospace !important;
    --purple-1: #8163bd;
    --purple-2: #79589F;
    --purple-3: #fd5eb8;
    --purple-light-1: rgba(99, 99, 172, .05);
    --purple-light-2: rgba(99, 99, 172, .1);
    --purple-light-3: rgba(99, 99, 172, .2);
    --purple-light-4: rgba(129, 99, 189, .3);
    --purple-light-5: #E9E4F0;
    --purple-light-6: rgba(129, 99, 189, .8);
}

/* html {
    font-size: 16px;
} */

body {
    font-family: var(--font-sans-serif);
    color: #34495e;
    -webkit-font-smoothing: antialiased;
    line-height: 1.6rem;
    letter-spacing: 0;
    margin: 0;
    overflow-x: hidden;
}

/* é¡µè¾¹è· å’Œ é¡µé¢å¤§å° */
#write {
    padding-left: 6ch;
    padding-right: 6ch;
    margin: 0 auto;
}

#write p {
    line-height: 1.6rem;
    word-spacing: .05rem;
}

#write ol li {
    padding-left: 0.5rem;
}

#write > ul:first-child,
#write > ol:first-child {
    margin-top: 30px;
}

body > *:first-child {
    margin-top: 0 !important;
}

body > *:last-child {
    margin-bottom: 0 !important;
}

a {
    color: var(--purple-1);
    padding: 0 2px;
    text-decoration: none;
}
.md-content {
    color: var(--purple-light-6);
}
#write a {
    border-bottom: 1px solid var(--purple-1);
    color: var(--purple-1);
    text-decoration: none;
}

h1,
h2,
h3,
h4,
h5,
h6 {
    position: relative;
    margin-top: 1rem;
    margin-bottom: 0.5rem;
    /* font-weight: bold; */
    font-weight: 500 !important;
    line-height: 1.4;
    cursor: text;
    color: var(--title-color);
    font-family: var(--font-sans-serif);
}

h1:hover a.anchor,
h2:hover a.anchor,
h3:hover a.anchor,
h4:hover a.anchor,
h5:hover a.anchor,
h6:hover a.anchor {
    text-decoration: none;
}

h1 tt,
h1 code {
    font-size: inherit !important;
}
h2 tt,
h2 code {
    font-size: inherit !important;
}
h3 tt,
h3 code {
    font-size: inherit !important;
}
h4 tt,
h4 code {
    font-size: inherit !important;
}
h5 tt,
h5 code {
    font-size: inherit !important;
}
h6 tt,
h6 code {
    font-size: inherit !important;
}


h1 {
    padding-bottom: .4rem;
    font-size: 2.2rem;
    line-height: 1.3;
}
h1 {
    text-align: center;
    padding-bottom: 0.3em;
    font-size: 2.2em;
    line-height: 1.2;
    margin: 2.4em auto 1.2em;
}
h1:after {
    content: '';
    display: block;
    margin: 0.2em auto 0;
    width: 100px;
    height: 2px;
    border-bottom: 2px solid var(--title-color);
}

h2 {
    margin: 1.6em auto 0.5em;
    padding-left: 10px;
    line-height: 1.4;
    font-size: 1.8em;
    border-left: 9px solid var(--title-color);
    border-bottom: 1px solid var(--title-color);
}
h3 {
    font-size: 1.5rem;
    margin: 1.2em auto 0.5em;
}
h4 {
    font-size: 1.3rem;
}
h5 {
    font-size: 1.2rem;
}
h6 {
    font-size: 1.1rem;
}

p,
blockquote,
ul,
ol,
dl,
table {
    margin: 0.8em 0;
}

li > ol,
li > ul {
    margin: 0 0;
}

hr {
    height: 2px;
    padding: 0;
    margin: 16px 0;
    background-color: #e7e7e7;
    border: 0 none;
    overflow: hidden;
    box-sizing: content-box;
}

body > h2:first-child {
    margin-top: 0;
    padding-top: 0;
}

body > h1:first-child {
    margin-top: 0;
    padding-top: 0;
}

body > h1:first-child + h2 {
    margin-top: 0;
    padding-top: 0;
}

body > h3:first-child,
body > h4:first-child,
body > h5:first-child,
body > h6:first-child {
    margin-top: 0;
    padding-top: 0;
}

a:first-child h1,
a:first-child h2,
a:first-child h3,
a:first-child h4,
a:first-child h5,
a:first-child h6 {
    margin-top: 0;
    padding-top: 0;
}

h1 p,
h2 p,
h3 p,
h4 p,
h5 p,
h6 p {
    margin-top: 0;
}

li p.first {
    display: inline-block;
}

ul,
ol {
    padding-left: 30px;
}

ul:first-child,
ol:first-child {
    margin-top: 0;
}

ul:last-child,
ol:last-child {
    margin-bottom: 0;
}

/* å¼•ç”¨ */
blockquote {
    /* margin-left: 1rem; */
    border-left: 4px solid var(--purple-light-4);
    padding: 10px 15px;
    color: #777;
    background-color: var(--purple-light-1);
}

/* è¡¨æ ¼ */
table {
    padding: 0;
    word-break: initial;
}

table tr {
    border-top: 1px solid #dfe2e5;
    margin: 0;
    padding: 0;
}

/* è¡¨æ ¼ èƒŒæ™¯è‰² */
table tr:nth-child(2n),
thead {
    background-color: var(--purple-light-1);
}
#write table thead th {
    background-color: var(--purple-light-2);
}

table tr th {
    font-weight: bold;
    border: 1px solid #dfe2e5;
    border-bottom: 0;
    text-align: left;
    margin: 0;
    padding: 6px 13px;
}

table tr td {
    border: 1px solid #dfe2e5;
    text-align: left;
    margin: 0;
    padding: 6px 13px;
}

table tr th:first-child,
table tr td:first-child {
    margin-top: 0;
}

table tr th:last-child,
table tr td:last-child {
    margin-bottom: 0;
}

/* ç²—ä½“ */
#write strong {
    padding: 0 2px;
    color: var(--purple-1);
}

/* æ–œä½“ */
#write em {
    padding: 0 5px 0 2px;
    /* font-style: normal; */
    color: #42b983;
}

/* inline code */
#write code, tt {
    padding: 2px 4px;
    border-radius: 2px;
    font-family: var(--font-monospace);
    font-size: 0.92rem;
    color: var(--purple-3); 
    background-color: rgba(99, 99, 172, .05);
}

tt {
    margin: 0 2px;
}

#write .md-footnote {
    background-color: #f8f8f8;
    color: var(--purple-3);
}

/* heighlight. */
#write mark {
    background-color: #fbd3ea;
    border-radius: 2px;
    padding: 2px 4px;
    margin: 0 2px;
}

#write del {
    padding: 1px 2px;
}

.md-task-list-item > input {
    margin-left: -1.3em;
}

@media print {
    html {
        font-size: 0.9rem;
    }

    table,
    pre {
        page-break-inside: avoid;
    }

    pre {
        word-wrap: break-word;
    }
}

#write pre.md-meta-block {
    padding: 1rem;
    font-size: 85%;
    line-height: 1.45;
    background-color: #f7f7f7;
    border: 0;
    border-radius: 3px;
    color: #777777;
    margin-top: 0 !important;
}

.mathjax-block > .code-tooltip {
    bottom: .375rem;
}

/* å›¾ç‰‡ */
.md-image > .md-meta {
    border-radius: 3px;
    font-family: var(--font-monospace);
    padding: 2px 0 0 4px;
    font-size: 0.9em;
    color: inherit;
}
p .md-image:only-child{
    width: auto;
    text-align: left;
    margin-left: 2rem;
}
.md-tag {
    color: inherit;
}
/* å½“ â€œ![shadow-éšä¾¿å†™]()â€å†™æ—¶ï¼Œä¼šæœ‰é˜´å½± */
.md-image img[alt|='shadow'] {
    /* box-shadow: 0 4px 24px -6px #ddd; */
    box-shadow:var(--purple-light-2) 0px 10px 15px;
}

#write a.md-toc-inner {
    line-height: 1.6;
    white-space: pre-line;
    border-bottom: none;
    font-size: 0.9rem;
}

#typora-quick-open {
    border: 1px solid #ddd;
    background-color: #f8f8f8;
}

#typora-quick-open-item {
    background-color: #FAFAFA;
    border-color: #FEFEFE #e5e5e5 #e5e5e5 #eee;
    border-style: solid;
    border-width: 1px;
}

#md-notification:before {
    top: 10px;
}

header,
.context-menu,
.megamenu-content,
footer {
    font-family: var(--font-sans-serif);
}

.file-node-content:hover .file-node-icon,
.file-node-content:hover .file-node-open-state {
    visibility: visible;
}

.md-lang {
    color: #b4654d;
}

.html-for-mac .context-menu {
    --item-hover-bg-color: #E6F0FE;
}

/* ä»£ç æ¡† */
/* CodeMirror 3024 Day theme */

/* ä»£ç æ®µ èƒŒæ™¯ */
pre {
    --select-text-bg-color: rgba(223, 197, 223) !important;
    margin: .5em 0;
    padding: 1em 1.4em;
    border-radius: 8px;
    background: #f6f8fa;
    overflow-x: auto;
    box-sizing: border-box;
    font-size: 14px;
}

/* è¾¹æ¡† */
.md-fences {
    border: 1px solid #e7eaed;
    border-radius: 3px;
}

.cm-s-inner {
  padding: .25rem;
  border-radius: .25rem;
}

.cm-s-inner.CodeMirror, .cm-s-inner .CodeMirror-gutters {
  background-color: #f8f8f8 !important;
  color: #3a3432 !important;
  border: none;
}

.cm-s-inner .CodeMirror-gutters {
  color: #6d8a88;
}

.cm-s-inner .CodeMirror-cursor {
  border-left: solid thin #5c5855 !important;
}

.cm-s-inner .CodeMirror-linenumber {
  color: #807d7c;
}

.cm-s-inner .CodeMirror-line::selection, .cm-s-inner .CodeMirror-line::-moz-selection,
.cm-s-inner .CodeMirror-line > span::selection,
.cm-s-inner .CodeMirror-line > span::-moz-selection,
.cm-s-inner .CodeMirror-line > span > span::selection,
.cm-s-inner .CodeMirror-line > span > span::-moz-selection {
  background: var(--purple-light-2);
}

.cm-s-inner span.cm-comment {
  color: #cdab53;
}

.cm-s-inner span.cm-string, .cm-s-inner span.cm-string-2 {
  color: #f2b01d;
}

.cm-s-inner span.cm-number {
  color: #a34e8f;
}

.cm-s-inner span.cm-variable {
  color: #01a252;
}

.cm-s-inner span.cm-variable-2 {
  color: #01a0e4;
}

.cm-s-inner span.cm-def {
  /* color: #e8bbd0; */
  color: #e2287f;
}

.cm-s-inner span.cm-operator {
  color: #ff79c6;
}

.cm-s-inner span.cm-keyword {
  color: #db2d20;
}

.cm-s-inner span.cm-atom {
  color: #a34e8f;
}

.cm-s-inner span.cm-meta {
  color: inherit;
}

.cm-s-inner span.cm-tag {
  color: #db2d20;
}

.cm-s-inner span.cm-attribute {
  color: #01a252;
}

.cm-s-inner span.cm-qualifier {
  color: #388aa3;
}

.cm-s-inner span.cm-property {
  color: #01a252;
}

.cm-s-inner span.cm-builtin {
  color: #388aa3;
}

.cm-s-inner span.cm-variable-3, .cm-s-inner span.cm-type {
  color: #ffb86c;
}

.cm-s-inner span.cm-bracket {
  color: #3a3432;
}

.cm-s-inner span.cm-link {
  color: #a34e8f;
}

.cm-s-inner span.cm-error {
  background: #db2d20;
  color: #5c5855;
}

/* .md-fences.md-focus .cm-s-inner .CodeMirror-activeline-background {
  background: var(--purple-light-2);
} */

.cm-s-inner .CodeMirror-matchingbracket {
  text-decoration: underline;
  color: #a34e8f !important;
}

#fences-auto-suggest .active {
  background: #ddd;
}

#write .code-tooltip {
  bottom: initial;
  top: calc(100% - 1px);
  background: #f7f7f7;
  border: 1px solid #ddd;
  border-top: 0;
}

.auto-suggest-container {
  border-color: #b4b4b4;
}

.auto-suggest-container .autoComplt-hint.active {
  background: #b4b4b4;
  color: inherit;
}

/* task list */
#write .md-task-list-item > input {
  -webkit-appearance: initial;
  display: block;
  position: absolute;
  border: 1px solid #b4b4b4;
  border-radius: .25rem;
  margin-top: .1rem;
  margin-left: -1.8rem;
  height: 1.2rem;
  width: 1.2rem;
  transition: background 0.3s;
}

#write .md-task-list-item > input:focus {
  outline: none;
  box-shadow: none;
}

#write .md-task-list-item > input:hover {
  background: #ddd;
}

#write .md-task-list-item > input[checked]::before {
  content: '';
  position: absolute;
  top: 20%;
  left: 50%;
  height: 60%;
  width: 2px;
  transform: rotate(40deg);
  background: #333;
}

#write .md-task-list-item > input[checked]::after {
  content: '';
  position: absolute;
  top: 46%;
  left: 25%;
  height: 30%;
  width: 2px;
  transform: rotate(-40deg);
  background: #333;
}

#write .md-task-list-item > p {
  transition: color 0.3s, opacity 0.3s;
}

#write .md-task-list-item.task-list-done > p {
  color: #b4b4b4;
  text-decoration: line-through;
}

#write .md-task-list-item.task-list-done > p > .md-emoji {
  opacity: .5;
}

#write .md-task-list-item.task-list-done > p > .md-link > a {
  opacity: .6;
}

/* sidebar and outline */
.pin-outline .outline-active {
  color: var(--active-file-text-color); 
}

.file-list-item {
    border-bottom: 1px solid;
    border-color: var(--purple-light-5);
}

.file-list-item-summary {
    font-weight: 400;
}

.file-list-item.active {
    color: var(--active-file-text-color);
    background-color: var(--purple-light-5);
}

.file-tree-node.active>.file-node-background {
    background-color: var(--purple-light-5);
    font-weight: 700;
} 

.file-tree-node.active>.file-node-content {
    color: var(--active-file-text-color);
    font-weight: 700;
}

.file-node-content {
    color: #5e676d;
}

.sidebar-tabs {
    border-bottom: none;
}
.sidebar-tab.active {
    font-weight: 400;
}

.sidebar-content-content {
    font-size: 0.9rem;
}

img {
    max-width: 100%;
}

body {
    background-color: rgb(237, 237, 237);
}
#content {
    width: 836px;
    padding: 50px;
    background: #fff;
    margin: 0 auto;
}/*# sourceURL=/Users/young/Documents/Codes/Fun/lagou/public/purple.css*/</style><style type="text/css">.hljs{display:block;overflow-x:auto;padding:.5em;color:#383a42;background:#fafafa}.hljs-comment,.hljs-quote{color:#a0a1a7;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e45649}.hljs-literal{color:#0184bb}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#50a14f}.hljs-built_in,.hljs-class .hljs-title{color:#c18401}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#4078f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}/*# sourceURL=/Users/young/Documents/Codes/Fun/lagou/public/atom-one-light.min.css*/</style></head>
<body>
<div id="content"><h1>åŸºç¡€ç¯‡-é«˜é˜¶ç»„ä»¶</h1>
<h2>ä¸€å‰è¨€</h2>
<p>æœ¬èŠ‚æ˜¯ React è¿›é˜¶ç³»åˆ—åŸºç¡€ç¯‡çš„æœ€åä¸€èŠ‚ï¼Œä¸»è¦ç»™å¤§å®¶è®²è§£ React é«˜é˜¶ç»„ä»¶- HOCã€‚æœ€è¿‘è°ƒç ”äº†å¾ˆå¤šåŒå­¦å¯¹é«˜é˜¶ç»„ä»¶çš„ä½¿ç”¨ä¸ç†è§£ï¼Œå¤§éƒ¨åˆ†åŒå­¦ç»™æˆ‘çš„å›å¤æ˜¯ï¼ŒçŸ¥é“é«˜é˜¶ç»„ä»¶ï¼Œä¹Ÿä¼šç”¨ä¸€äº›ä¼˜ç§€çš„å¼€æºåº“ä¸­çš„é«˜é˜¶ç»„ä»¶ï¼Œä½†æ˜¯è‡ªå·±é‡åˆ°ä¸šåŠ¡åœºæ™¯çš„æ—¶å€™ï¼Œ<strong>æƒ³ä¸åˆ°ç”¨é«˜é˜¶ç»„ä»¶è§£å†³é—®é¢˜</strong>æˆ–è€…<strong>ä¸çŸ¥é“æ€ä¹ˆç¼–å†™é«˜é˜¶ç»„ä»¶</strong>ï¼Ÿ</p>
<p>ä»å°ä¼™ä¼´ä»¬çš„å›ç­”ä¸­ï¼Œæˆ‘æ‰¾åˆ°äº†æœ¬ç« èŠ‚é‡ç‚¹çš„è®¨è®ºæ–¹å‘ï¼Œå°±æ˜¯ <strong>HOC è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Œä»€ä¹ˆæ—¶å€™ç”¨åˆ° HOCï¼Œä»¥åŠå¦‚ä½•ç¼–å†™ HOC ?</strong></p>
<h2>äºŒé«˜é˜¶ç»„ä»¶åŸºæœ¬ä»‹ç»-èƒ½è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ</h2>
<h3>1 é«˜é˜¶ç»„ä»¶èƒ½è§£å†³ä»€ä¹ˆé—®é¢˜</h3>
<p>é«˜çº§ç»„ä»¶åˆ°åº•èƒ½å¤Ÿè§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿä¸¾ä¸€ä¸ªç‰¹åˆ«ç®€å•çš„ä¾‹å­ï¼Œè¯è¯´å°æ˜è´Ÿè´£å¼€å‘ä¸€ä¸ª web åº”ç”¨ï¼Œåº”ç”¨çš„ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼Œè€Œä¸”è¿™ä¸ªåŠŸèƒ½å°æ˜å·²ç»å¼€å‘å®Œäº†ã€‚</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c4effb7bd6764e80ab0e7c25e177d56e~tplv-k3u1fbpfcp-watermark.image" alt="hoc2.jpg"></p>
<p>ä½†æ˜¯ï¼Œæœ‰ä¸€å¤©è€æ¿çªç„¶æå‡ºäº†ä¸€ä¸ªæƒé™éš”ç¦»çš„éœ€æ±‚ï¼Œå°±æ˜¯éƒ¨åˆ†æ¨¡å—ç»„ä»¶å—åˆ°æƒé™æ§åˆ¶ï¼Œåå°çš„æ•°æ®äº¤äº’çš„ç»“æœæƒé™æ§åˆ¶ç€æ¨¡å—å±•ç¤ºä¸å¦ï¼Œè€Œä¸”æ²¡æœ‰æƒé™ä¼šé»˜è®¤å±•ç¤ºæ— æƒé™æç¤ºé¡µé¢ã€‚ï¼ˆå¦‚ä¸‹å›¾ï¼Œé»„è‰²éƒ¨åˆ†æ˜¯å—åˆ°æƒé™æ§åˆ¶çš„ç»„ä»¶æ¨¡å—ï¼‰</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/79bc49c43520456182a88610b8eb3f1e~tplv-k3u1fbpfcp-watermark.image" alt="hoc3.jpg"></p>
<p>é‚£ä¹ˆå°æ˜é¢ä¸´çš„é—®é¢˜æ˜¯ï¼Œå¦‚ä½•ç»™éœ€è¦æƒé™éš”ç¦»çš„æ¨¡å—ï¼Œç»‘å®šæƒé™å‘¢ï¼Ÿé‚£ç¬¬ä¸€ç§æ€è·¯æ˜¯æŠŠæ‰€æœ‰çš„éœ€è¦æƒé™éš”ç¦»çš„æ¨¡å—é‡æ–°ç»‘å®šæƒé™ï¼Œé€šè¿‡æƒé™æ¥åˆ¤æ–­ç»„ä»¶æ˜¯å¦å±•ç¤ºã€‚</p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3f02c232062048cb88f1c39e8afc7862~tplv-k3u1fbpfcp-watermark.image" alt="hoc4.jpg"></p>
<p>è¿™æ ·æ— ç–‘ä¼šç»™å°æ˜å¸¦æ¥å¾ˆå¤šçš„å·¥ä½œé‡ï¼Œè€Œä¸”åç»­é¡¹ç›®å¯èƒ½è¿˜æœ‰å—æƒé™æ§åˆ¶çš„é¡µé¢æˆ–è€…ç»„ä»¶ï¼Œéƒ½éœ€è¦æ‰‹åŠ¨ç»‘å®šæƒé™ã€‚é‚£ä¹ˆå¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Œæ€è€ƒä¸€ä¸‹ï¼Œæ—¢ç„¶æ˜¯åˆ¤æ–­æƒé™ï¼Œé‚£ä¹ˆå¯ä»¥æŠŠé€»è¾‘éƒ½å†™åœ¨ä¸€ä¸ªå®¹å™¨é‡Œï¼Œç„¶åå°†æ¯ä¸ªéœ€è¦æƒé™çš„ç»„ä»¶é€šè¿‡å®¹å™¨åŒ…è£…ä¸€å±‚ï¼Œè¿™æ ·ä¸å°±ä¸éœ€è¦é€ä¸€æ‰‹åŠ¨ç»‘å®šæƒé™äº†å—ï¼Ÿæ‰€ä»¥ HOC å¯ä»¥åˆç†çš„è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œé€šè¿‡ HOC æ¨¡å¼ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/aa0f9b5e798947c9aa563c7213ef7b87~tplv-k3u1fbpfcp-watermark.image" alt="hoc5.jpg"></p>
<p>ç»¼ä¸Šæ‰€è¿°ï¼ŒHOCçš„äº§ç”Ÿæ ¹æœ¬ä½œç”¨å°±æ˜¯è§£å†³å¤§é‡çš„ä»£ç å¤ç”¨ï¼Œé€»è¾‘å¤ç”¨é—®é¢˜ã€‚æ—¢ç„¶è¯´åˆ°äº†é€»è¾‘å¤ç”¨ï¼Œé‚£ä¹ˆå…·ä½“å¤ç”¨äº†å“ªäº›é€»è¾‘å‘¢ï¼Ÿ</p>
<ul>
<li>
<p>é¦–å…ˆç¬¬ä¸€ç§å°±æ˜¯åƒä¸Šè¿°çš„æ‹¦æˆªé—®é¢˜ï¼Œæœ¬è´¨ä¸Šæ˜¯å¯¹æ¸²æŸ“çš„æ§åˆ¶ï¼Œå¯¹æ¸²æŸ“çš„æ§åˆ¶å¯ä¸ä»…ä»…æŒ‡æ˜¯å¦æ¸²æŸ“ç»„ä»¶ï¼Œè¿˜å¯ä»¥åƒ dva ä¸­ dynamic é‚£æ ·æ‡’åŠ è½½/åŠ¨æ€åŠ è½½ç»„ä»¶ã€‚</p>
</li>
<li>
<p>è¿˜æœ‰ä¸€ç§åœºæ™¯ï¼Œæ¯”å¦‚é¡¹ç›®ä¸­æƒ³è®©ä¸€ä¸ªé Route ç»„ä»¶ï¼Œä¹Ÿèƒ½é€šè¿‡ props è·å–è·¯ç”±å®ç°è·³è½¬ï¼Œä½†æ˜¯ä¸æƒ³é€šè¿‡çˆ¶çº§è·¯ç”±ç»„ä»¶å±‚å±‚ç»‘å®š props ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦ä¸€ä¸ª HOC æŠŠæ”¹å˜è·¯ç”±çš„ history å¯¹è±¡æ··å…¥ props ä¸­ï¼Œäºæ˜¯ withRoute è¯ç”Ÿäº†ã€‚æ‰€ä»¥ HOC è¿˜æœ‰ä¸€ä¸ªé‡è¦çš„ä½œç”¨å°±æ˜¯è®© props ä¸­æ··å…¥ä¸€äº›ä½ éœ€è¦çš„ä¸œè¥¿ã€‚</p>
</li>
<li>
<p>è¿˜æœ‰ä¸€ç§æƒ…å†µï¼Œå¦‚æœä¸æƒ³æ”¹å˜ç»„ä»¶ï¼Œåªæ˜¯ç›‘æ§ç»„ä»¶çš„å†…éƒ¨çŠ¶æ€ï¼Œå¯¹ç»„ä»¶åšä¸€äº›èµ‹èƒ½ï¼ŒHOC ä¹Ÿæ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œæ¯”å¦‚å¯¹ç»„ä»¶å†…çš„ç‚¹å‡»äº‹ä»¶åšä¸€äº›ç›‘æ§ï¼Œæˆ–è€…åŠ ä¸€æ¬¡é¢å¤–çš„ç”Ÿå‘½å‘¨æœŸï¼Œæˆ‘ä¹‹å‰å†™è¿‡ä¸€ä¸ªå¼€æºé¡¹ç›® <code>react-keepalive-router</code>ï¼Œå¯ä»¥ç¼“å­˜é¡µé¢ï¼Œé¡¹ç›®ä¸­çš„ keepaliveLifeCycle å°±æ˜¯é€šè¿‡ HOC æ–¹å¼ï¼Œç»™ä¸šåŠ¡ç»„ä»¶å¢åŠ äº†é¢å¤–çš„ç”Ÿå‘½å‘¨æœŸã€‚</p>
</li>
</ul>
<h3>é«˜é˜¶ç»„ä»¶åŸºç¡€æ¦‚å¿µ</h3>
<p>é«˜é˜¶ç»„ä»¶çœŸçš„å¾ˆå¥½ç†è§£ï¼Œéƒ½çŸ¥é“é«˜é˜¶å‡½æ•°å°±æ˜¯ä¸€ä¸ªå°†å‡½æ•°ä½œä¸ºå‚æ•°å¹¶ä¸”è¿”å›å€¼ä¹Ÿæ˜¯å‡½æ•°çš„å‡½æ•°ã€‚é«˜é˜¶ç»„ä»¶æ˜¯ä»¥ç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œè¿”å›ç»„ä»¶çš„å‡½æ•°ã€‚è¿”å›çš„ç»„ä»¶æŠŠä¼ è¿›å»çš„ç»„ä»¶è¿›è¡ŒåŠŸèƒ½å¼ºåŒ–ã€‚</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/97a76447f740458f91982e4038e46d2e~tplv-k3u1fbpfcp-watermark.image" alt="hoc6.jpg"></p>
<h3>ä¸¤ç§ä¸åŒçš„é«˜é˜¶ç»„ä»¶</h3>
<p>å¸¸ç”¨çš„é«˜é˜¶ç»„ä»¶æœ‰<strong>å±æ€§ä»£ç†</strong>å’Œ<strong>åå‘ç»§æ‰¿</strong>ä¸¤ç§ï¼Œä¸¤è€…ä¹‹é—´æœ‰ä¸€äº›å…±æ€§å’ŒåŒºåˆ«ã€‚æ¥ä¸‹æ¥åˆ†åˆ«ä»‹ç»ä¸€ä¸‹ä¸¤ç§æ¨¡å¼ä¸‹çš„é«˜é˜¶ç»„ä»¶ã€‚</p>
<p><strong>å±æ€§ä»£ç†</strong></p>
<p>å±æ€§ä»£ç†ï¼Œå°±æ˜¯ç”¨ç»„ä»¶åŒ…è£¹ä¸€å±‚ä»£ç†ç»„ä»¶ï¼Œåœ¨ä»£ç†ç»„ä»¶ä¸Šï¼Œå¯ä»¥åšä¸€äº›ï¼Œå¯¹æºç»„ä»¶çš„å¼ºåŒ–æ“ä½œã€‚è¿™é‡Œæ³¨æ„å±æ€§ä»£ç†è¿”å›çš„æ˜¯ä¸€ä¸ªæ–°ç»„ä»¶ï¼Œè¢«åŒ…è£¹çš„åŸå§‹ç»„ä»¶ï¼Œå°†åœ¨æ–°çš„ç»„ä»¶é‡Œè¢«æŒ‚è½½ã€‚</p>
<pre><code class="hljs language-js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">HOC</span>(<span class="hljs-params">WrapComponent</span>)</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Advance</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span></span>{
       state={
           <span class="hljs-attr">name</span>:<span class="hljs-string">'alien'</span>
       }
       <span class="hljs-function"><span class="hljs-title">render</span>(<span class="hljs-params"></span>)</span>{
           <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">WrapComponent</span>  { <span class="hljs-attr">...this.props</span> } { <span class="hljs-attr">...this.state</span> }  /></span></span>
       }
    }
}
</code></pre>
<p>ä¼˜ç‚¹ï¼š</p>
<ul>
<li>â‘  å±æ€§ä»£ç†å¯ä»¥å’Œä¸šåŠ¡ç»„ä»¶ä½è€¦åˆï¼Œé›¶è€¦åˆï¼Œå¯¹äºæ¡ä»¶æ¸²æŸ“å’Œ props å±æ€§å¢å¼ºï¼Œåªè´Ÿè´£æ§åˆ¶å­ç»„ä»¶æ¸²æŸ“å’Œä¼ é€’é¢å¤–çš„ props å°±å¯ä»¥äº†ï¼Œæ‰€ä»¥æ— é¡»çŸ¥é“ï¼Œä¸šåŠ¡ç»„ä»¶åšäº†äº›ä»€ä¹ˆã€‚æ‰€ä»¥æ­£å‘å±æ€§ä»£ç†ï¼Œæ›´é€‚åˆåšä¸€äº›å¼€æºé¡¹ç›®çš„ HOC ï¼Œç›®å‰å¼€æºçš„ HOC åŸºæœ¬éƒ½æ˜¯é€šè¿‡è¿™ä¸ªæ¨¡å¼å®ç°çš„ã€‚</li>
<li>â‘¡ åŒæ ·é€‚ç”¨äºç±»ç»„ä»¶å’Œå‡½æ•°ç»„ä»¶ã€‚</li>
<li>â‘¢ å¯ä»¥å®Œå…¨éš”ç¦»ä¸šåŠ¡ç»„ä»¶çš„æ¸²æŸ“ï¼Œå› ä¸ºå±æ€§ä»£ç†è¯´ç™½äº†æ˜¯ä¸€ä¸ªæ–°çš„ç»„ä»¶ï¼Œç›¸æ¯”åå‘ç»§æ‰¿ï¼Œå¯ä»¥å®Œå…¨æ§åˆ¶ä¸šåŠ¡ç»„ä»¶æ˜¯å¦æ¸²æŸ“ã€‚</li>
<li>â‘£ å¯ä»¥åµŒå¥—ä½¿ç”¨ï¼Œå¤šä¸ª HOC æ˜¯å¯ä»¥åµŒå¥—ä½¿ç”¨çš„ï¼Œè€Œä¸”ä¸€èˆ¬ä¸ä¼šé™åˆ¶åŒ…è£… HOC çš„å…ˆåé¡ºåºã€‚</li>
</ul>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>â‘  ä¸€èˆ¬æ— æ³•ç›´æ¥è·å–åŸå§‹ç»„ä»¶çš„çŠ¶æ€ï¼Œå¦‚æœæƒ³è¦è·å–ï¼Œéœ€è¦ ref è·å–ç»„ä»¶å®ä¾‹ã€‚</li>
<li>â‘¡ æ— æ³•ç›´æ¥ç»§æ‰¿é™æ€å±æ€§ã€‚å¦‚æœéœ€è¦ç»§æ‰¿éœ€è¦æ‰‹åŠ¨å¤„ç†ï¼Œæˆ–è€…å¼•å…¥ç¬¬ä¸‰æ–¹åº“ã€‚</li>
<li>â‘¢ å› ä¸ºæœ¬è´¨ä¸Šæ˜¯äº§ç”Ÿäº†ä¸€ä¸ªæ–°ç»„ä»¶ï¼Œæ‰€ä»¥éœ€è¦é…åˆ forwardRef æ¥è½¬å‘ refã€‚</li>
</ul>
<p><strong>åå‘ç»§æ‰¿</strong></p>
<p>åå‘ç»§æ‰¿å’Œå±æ€§ä»£ç†æœ‰ä¸€å®šçš„åŒºåˆ«ï¼Œåœ¨äºåŒ…è£…åçš„ç»„ä»¶ç»§æ‰¿äº†åŸå§‹ç»„ä»¶æœ¬èº«ï¼Œæ‰€ä»¥æ­¤æ—¶æ— é¡»å†å»æŒ‚è½½ä¸šåŠ¡ç»„ä»¶ã€‚</p>
<pre><code class="hljs language-js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Index</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span></span>{
  <span class="hljs-function"><span class="hljs-title">render</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">div</span>></span> hello,world  <span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span></span>
  }
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">HOC</span>(<span class="hljs-params">Component</span>)</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">wrapComponent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span></span>{ <span class="hljs-comment">/* ç›´æ¥ç»§æ‰¿éœ€è¦åŒ…è£…çš„ç»„ä»¶ */</span>
        
    }
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> HOC(Index) 
</code></pre>
<p>ä¼˜ç‚¹ï¼š</p>
<ul>
<li>â‘  æ–¹ä¾¿è·å–ç»„ä»¶å†…éƒ¨çŠ¶æ€ï¼Œæ¯”å¦‚ state ï¼Œprops ï¼Œç”Ÿå‘½å‘¨æœŸï¼Œç»‘å®šçš„äº‹ä»¶å‡½æ•°ç­‰ã€‚</li>
<li>â‘¡ es6ç»§æ‰¿å¯ä»¥è‰¯å¥½ç»§æ‰¿é™æ€å±æ€§ã€‚æ‰€ä»¥æ— é¡»å¯¹é™æ€å±æ€§å’Œæ–¹æ³•è¿›è¡Œé¢å¤–çš„å¤„ç†ã€‚</li>
</ul>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>â‘  å‡½æ•°ç»„ä»¶æ— æ³•ä½¿ç”¨ã€‚</li>
<li>â‘¡ å’Œè¢«åŒ…è£…çš„ç»„ä»¶è€¦åˆåº¦é«˜ï¼Œéœ€è¦çŸ¥é“è¢«åŒ…è£…çš„åŸå§‹ç»„ä»¶çš„å†…éƒ¨çŠ¶æ€ï¼Œå…·ä½“åšäº†äº›ä»€ä¹ˆï¼Ÿ</li>
<li>â‘¢ å¦‚æœå¤šä¸ªåå‘ç»§æ‰¿ HOC åµŒå¥—åœ¨ä¸€èµ·ï¼Œå½“å‰çŠ¶æ€ä¼šè¦†ç›–ä¸Šä¸€ä¸ªçŠ¶æ€ã€‚è¿™æ ·å¸¦æ¥çš„éšæ‚£æ˜¯éå¸¸å¤§çš„ï¼Œæ¯”å¦‚è¯´æœ‰å¤šä¸ª componentDidMount ï¼Œå½“å‰ componentDidMount ä¼šè¦†ç›–ä¸Šä¸€ä¸ª componentDidMount ã€‚è¿™æ ·å‰¯ä½œç”¨ä¸²è”èµ·æ¥ï¼Œå½±å“å¾ˆå¤§ã€‚</li>
</ul>
<h2>ä¸‰ é«˜é˜¶ç»„ä»¶åŠŸèƒ½è¯´æ˜-å¦‚ä½•ç¼–å†™é«˜é˜¶ç»„ä»¶ï¼Ÿ</h2>
<h3>1 å¼ºåŒ–props</h3>
<p>å¼ºåŒ– props å°±æ˜¯åœ¨åŸå§‹ç»„ä»¶çš„ props åŸºç¡€ä¸Šï¼ŒåŠ å…¥ä¸€äº›å…¶ä»–çš„ props ï¼Œå¼ºåŒ–åŸå§‹ç»„ä»¶åŠŸèƒ½ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¸ºäº†è®©ç»„ä»¶ä¹Ÿå¯ä»¥è·å–åˆ°è·¯ç”±å¯¹è±¡ï¼Œè¿›è¡Œè·¯ç”±è·³è½¬ç­‰æ“ä½œï¼Œæ‰€ä»¥ React Router æä¾›äº†ç±»ä¼¼ withRouter çš„ HOC ã€‚</p>
<pre><code class="hljs language-js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">withRouter</span>(<span class="hljs-params">Component</span>) </span>{
  <span class="hljs-keyword">const</span> displayName = <span class="hljs-string">`withRouter(<span class="hljs-subst">${Component.displayName || Component.name}</span>)`</span>;
  <span class="hljs-keyword">const</span> C = <span class="hljs-function"><span class="hljs-params">props</span> =></span> {
      <span class="hljs-comment">/*  è·å– */</span>
    <span class="hljs-keyword">const</span> { wrappedComponentRef, ...remainingProps } = props;
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">RouterContext.Consumer</span>></span>
        {context => {
          return (
            <span class="hljs-tag">&#x3C;<span class="hljs-name">Component</span>
              {<span class="hljs-attr">...remainingProps</span>} // ç»„ä»¶åŸå§‹çš„<span class="hljs-attr">props</span> 
              {<span class="hljs-attr">...context</span>}        // å­˜åœ¨è·¯ç”±å¯¹è±¡çš„ä¸Šä¸‹æ–‡ï¼Œ<span class="hljs-attr">history</span>  <span class="hljs-attr">location</span> ç­‰ 
              <span class="hljs-attr">ref</span>=<span class="hljs-string">{wrappedComponentRef}</span>
            /></span>
          );
        }}
      <span class="hljs-tag">&#x3C;/<span class="hljs-name">RouterContext.Consumer</span>></span></span>
    );
  };

  C.displayName = displayName;
  C.WrappedComponent = Component;
  <span class="hljs-comment">/* ç»§æ‰¿é™æ€å±æ€§ */</span>
  <span class="hljs-keyword">return</span> hoistStatics(C, Component);
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> withRouter
</code></pre>
<p>æµç¨‹åˆ†æï¼š</p>
<ul>
<li>åˆ†ç¦»å‡º props ä¸­ wrappedComponentRef å’Œ remainingProps ï¼Œ remainingProps æ˜¯åŸå§‹ç»„ä»¶çœŸæ­£çš„ propsï¼Œ wrappedComponentRef ç”¨äºè½¬å‘ refã€‚</li>
<li>ç”¨ Context.Consumer ä¸Šä¸‹æ–‡æ¨¡å¼è·å–ä¿å­˜çš„è·¯ç”±ä¿¡æ¯ã€‚ï¼ˆ React Router ä¸­è·¯ç”±çŠ¶æ€æ˜¯é€šè¿‡ context ä¸Šä¸‹æ–‡ä¿å­˜ä¼ é€’çš„ï¼‰</li>
<li>å°†è·¯ç”±å¯¹è±¡å’ŒåŸå§‹ props ä¼ é€’ç»™åŸå§‹ç»„ä»¶ï¼Œæ‰€ä»¥å¯ä»¥åœ¨åŸå§‹ç»„ä»¶ä¸­è·å– history ï¼Œlocation ç­‰ä¿¡æ¯ã€‚</li>
</ul>
<h3>2 æ§åˆ¶æ¸²æŸ“</h3>
<h4>æ¸²æŸ“åŠ«æŒ</h4>
<p>HOC åå‘ç»§æ‰¿æ¨¡å¼ï¼Œå¯ä»¥é€šè¿‡ super.render() å¾—åˆ° render ä¹‹åçš„å†…å®¹ï¼Œåˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œå¯ä»¥åšæ¸²æŸ“åŠ«æŒ ï¼Œæ›´æœ‰ç”šè€…å¯ä»¥ä¿®æ”¹ render ä¹‹åçš„ React element å¯¹è±¡ã€‚</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> HOC = <span class="hljs-function">(<span class="hljs-params">WrapComponent</span>) =></span>
  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Index</span>  <span class="hljs-keyword">extends</span> <span class="hljs-title">WrapComponent</span> </span>{
    <span class="hljs-function"><span class="hljs-title">render</span>(<span class="hljs-params"></span>)</span> {
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.props.visible) {
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.render()
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">div</span>></span>æš‚æ— æ•°æ®<span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span></span>
      }
    }
  }

</code></pre>
<p><strong>ä¿®æ”¹æ¸²æŸ“æ ‘</strong></p>
<pre><code class="hljs language-js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Index</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span></span>{
  <span class="hljs-function"><span class="hljs-title">render</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">div</span>></span>
       <span class="hljs-tag">&#x3C;<span class="hljs-name">ul</span>></span>
         <span class="hljs-tag">&#x3C;<span class="hljs-name">li</span>></span>react<span class="hljs-tag">&#x3C;/<span class="hljs-name">li</span>></span>
         <span class="hljs-tag">&#x3C;<span class="hljs-name">li</span>></span>vue<span class="hljs-tag">&#x3C;/<span class="hljs-name">li</span>></span>
         <span class="hljs-tag">&#x3C;<span class="hljs-name">li</span>></span>Angular<span class="hljs-tag">&#x3C;/<span class="hljs-name">li</span>></span>
       <span class="hljs-tag">&#x3C;/<span class="hljs-name">ul</span>></span>
    <span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span></span>
  }
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">HOC</span> (<span class="hljs-params">Component</span>)</span>{
  <span class="hljs-keyword">return</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Advance</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{
    <span class="hljs-function"><span class="hljs-title">render</span>(<span class="hljs-params"></span>)</span> {
      <span class="hljs-keyword">const</span> element = <span class="hljs-built_in">super</span>.render()
      <span class="hljs-keyword">const</span> otherProps = {
        <span class="hljs-attr">name</span>:<span class="hljs-string">'alien'</span>
      }
      <span class="hljs-comment">/* æ›¿æ¢ Angular å…ƒç´ èŠ‚ç‚¹ */</span>
      <span class="hljs-keyword">const</span> appendElement = React.createElement(<span class="hljs-string">'li'</span> ,{} , <span class="hljs-string">`hello ,world , my name  is <span class="hljs-subst">${ otherProps.name }</span>`</span> )
      <span class="hljs-keyword">const</span> newchild =  React.Children.map(element.props.children.props.children,<span class="hljs-function">(<span class="hljs-params">child,index</span>)=></span>{
           <span class="hljs-keyword">if</span>(index === <span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> appendElement
           <span class="hljs-keyword">return</span>  child
      }) 
      <span class="hljs-keyword">return</span>  React.cloneElement(element, element.props, newchild)
    }
  }
}
<span class="hljs-keyword">export</span>  <span class="hljs-keyword">default</span> HOC(Index)
</code></pre>
<p><strong>æ•ˆæœ</strong></p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8768ee8201e949d8a7c2f7c0ec72b1e4~tplv-k3u1fbpfcp-watermark.image" alt="40D6BF30-9B4C-4EC9-B089-1E757DAC15DF.jpg"></p>
<h4>åŠ¨æ€åŠ è½½</h4>
<p>dva ä¸­ dynamic å°±æ˜¯é…åˆ import ï¼Œå®ç°ç»„ä»¶çš„åŠ¨æ€åŠ è½½çš„ï¼Œè€Œä¸”æ¯æ¬¡åˆ‡æ¢è·¯ç”±ï¼Œéƒ½ä¼šæœ‰ Loading æ•ˆæœï¼Œæ¥ä¸‹æ¥çœ‹çœ‹å¤§è‡´çš„å®ç°æ€è·¯ã€‚</p>
<p><strong>ç¼–å†™</strong></p>
<pre><code class="hljs language-js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">dynamicHoc</span>(<span class="hljs-params">loadRouter</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Content</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
    state = {<span class="hljs-attr">Component</span>: <span class="hljs-literal">null</span>}
    <span class="hljs-function"><span class="hljs-title">componentDidMount</span>(<span class="hljs-params"></span>)</span> {
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.state.Component) <span class="hljs-keyword">return</span>
      loadRouter()
        .then(<span class="hljs-function"><span class="hljs-params">module</span> =></span> <span class="hljs-built_in">module</span>.default) <span class="hljs-comment">// åŠ¨æ€åŠ è½½ component ç»„ä»¶</span>
        .then(<span class="hljs-function"><span class="hljs-params">Component</span> =></span> <span class="hljs-built_in">this</span>.setState({Component},
         ))
    }
    <span class="hljs-function"><span class="hljs-title">render</span>(<span class="hljs-params"></span>)</span> {
      <span class="hljs-keyword">const</span> {Component} = <span class="hljs-built_in">this</span>.state
      <span class="hljs-keyword">return</span> Component ? <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">Component</span> {
      <span class="hljs-attr">...this.props</span>
      }
      /></span></span> : <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">Loading</span> /></span></span>
    }
  }
}
</code></pre>
<p><strong>ä½¿ç”¨</strong></p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> Index = AsyncRouter(<span class="hljs-function">()=></span><span class="hljs-keyword">import</span>(<span class="hljs-string">'../pages/index'</span>))
</code></pre>
<p>å®ç°æ€è·¯ï¼š</p>
<ul>
<li>Index ç»„ä»¶ä¸­ï¼Œåœ¨ componentDidMount ç”Ÿå‘½å‘¨æœŸåŠ¨æ€åŠ è½½ä¸Šè¿°çš„è·¯ç”±ç»„ä»¶Componentï¼Œå¦‚æœåœ¨åˆ‡æ¢è·¯ç”±æˆ–è€…æ²¡æœ‰åŠ è½½å®Œæ¯•æ—¶ï¼Œæ˜¾ç¤ºçš„æ˜¯ Loading æ•ˆæœã€‚</li>
</ul>
<h3>3 ç»„ä»¶èµ‹èƒ½</h3>
<h4>refè·å–å®ä¾‹</h4>
<p>å¯¹äºå±æ€§ä»£ç†è™½ç„¶ä¸èƒ½ç›´æ¥è·å–ç»„ä»¶å†…çš„çŠ¶æ€ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡ ref è·å–ç»„ä»¶å®ä¾‹ï¼Œè·å–åˆ°ç»„ä»¶å®ä¾‹ï¼Œå°±å¯ä»¥è·å–ç»„ä»¶çš„ä¸€äº›çŠ¶æ€ï¼Œæˆ–æ˜¯æ‰‹åŠ¨è§¦å‘ä¸€äº›äº‹ä»¶ï¼Œè¿›ä¸€æ­¥å¼ºåŒ–ç»„ä»¶ï¼Œä½†æ˜¯æ³¨æ„çš„æ˜¯ï¼šç±»ç»„ä»¶æ‰å­˜åœ¨å®ä¾‹ï¼Œå‡½æ•°ç»„ä»¶ä¸å­˜åœ¨å®ä¾‹ã€‚</p>
<pre><code class="hljs language-js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Hoc</span>(<span class="hljs-params">Component</span>)</span>{
  <span class="hljs-keyword">return</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WrapComponent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span></span>{
      <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params"></span>)</span>{
        <span class="hljs-built_in">super</span>()
        <span class="hljs-built_in">this</span>.node = <span class="hljs-literal">null</span> <span class="hljs-comment">/* è·å–å®ä¾‹ï¼Œå¯ä»¥åšä¸€äº›å…¶ä»–çš„æ“ä½œã€‚ */</span>
      }
      <span class="hljs-function"><span class="hljs-title">render</span>(<span class="hljs-params"></span>)</span>{
        <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">Component</span> {<span class="hljs-attr">...this.props</span>}  <span class="hljs-attr">ref</span>=<span class="hljs-string">{(node)</span> =></span> this.node = node }  /></span>
      }
  }
}
</code></pre>
<h4>äº‹ä»¶ç›‘æ§</h4>
<p>HOC ä¸ä¸€å®šéè¦å¯¹ç»„ä»¶æœ¬èº«åšäº›ä»€ä¹ˆï¼Ÿä¹Ÿå¯ä»¥å•çº¯å¢åŠ ä¸€äº›äº‹ä»¶ç›‘å¬ï¼Œé”™è¯¯ç›‘æ§ã€‚æ¥ä¸‹æ¥ï¼Œæ¥ä¸‹æ¥åšä¸€ä¸ª <code>HOC</code> ï¼Œåªå¯¹ç»„ä»¶å†…çš„ç‚¹å‡»äº‹ä»¶åšä¸€ä¸ªç›‘å¬æ•ˆæœã€‚</p>
<pre><code class="hljs language-js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ClickHoc</span> (<span class="hljs-params">Component</span>)</span>{
  <span class="hljs-keyword">return</span>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Wrap</span>(<span class="hljs-params">props</span>)</span>{
    <span class="hljs-keyword">const</span> dom = useRef(<span class="hljs-literal">null</span>)
    useEffect(<span class="hljs-function">()=></span>{
       <span class="hljs-keyword">const</span> handerClick = <span class="hljs-function">() =></span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'å‘ç”Ÿç‚¹å‡»äº‹ä»¶'</span>) 
       dom.current.addEventListener(<span class="hljs-string">'click'</span>,handerClick)
     <span class="hljs-keyword">return</span> <span class="hljs-function">() =></span> dom.current.removeEventListener(<span class="hljs-string">'click'</span>,handerClick)
    },[])
    <span class="hljs-keyword">return</span>  <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">div</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{dom}</span>  ></span><span class="hljs-tag">&#x3C;<span class="hljs-name">Component</span>  {<span class="hljs-attr">...props</span>} /></span><span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span></span>
  }
}

@ClickHoc
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Index</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span></span>{
   <span class="hljs-function"><span class="hljs-title">render</span>(<span class="hljs-params"></span>)</span>{
     <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">'index'</span>  ></span>
       <span class="hljs-tag">&#x3C;<span class="hljs-name">p</span>></span>helloï¼Œworld<span class="hljs-tag">&#x3C;/<span class="hljs-name">p</span>></span>
       <span class="hljs-tag">&#x3C;<span class="hljs-name">button</span>></span>ç»„ä»¶å†…éƒ¨ç‚¹å‡»<span class="hljs-tag">&#x3C;/<span class="hljs-name">button</span>></span>
    <span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span></span>
   }
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> ()=>{
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">'box'</span>  ></span>
     <span class="hljs-tag">&#x3C;<span class="hljs-name">Index</span> /></span>
     <span class="hljs-tag">&#x3C;<span class="hljs-name">button</span>></span>ç»„ä»¶å¤–éƒ¨ç‚¹å‡»<span class="hljs-tag">&#x3C;/<span class="hljs-name">button</span>></span>
  <span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span></span>
}
</code></pre>
<p><strong>æ•ˆæœ</strong></p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2e80fb646d654536af836b7d038fd62b~tplv-k3u1fbpfcp-watermark.image" alt="click.gif"></p>
<h3>4 æ€»ç»“</h3>
<p>ä¸‹é¢å¯¹ HOC å…·ä½“èƒ½å®ç°é‚£äº›åŠŸèƒ½ï¼Œå’Œå¦‚ä½•ç¼–å†™åšä¸€ä¸‹æ€»ç»“ï¼š</p>
<ul>
<li>1 å¼ºåŒ– props ï¼Œå¯ä»¥é€šè¿‡ HOC ï¼Œå‘åŸå§‹ç»„ä»¶æ··å…¥ä¸€äº›çŠ¶æ€ã€‚</li>
<li>2 æ¸²æŸ“åŠ«æŒï¼Œå¯ä»¥åˆ©ç”¨ HOC ï¼ŒåŠ¨æ€æŒ‚è½½åŸå§‹ç»„ä»¶ï¼Œè¿˜å¯ä»¥å…ˆè·å–åŸå§‹ç»„ä»¶çš„æ¸²æŸ“æ ‘ï¼Œè¿›è¡Œå¯æ§æ€§ä¿®æ”¹ã€‚</li>
<li>3 å¯ä»¥é…åˆ import ç­‰ api ï¼Œå®ç°åŠ¨æ€åŠ è½½ç»„ä»¶ï¼Œå®ç°ä»£ç åˆ†å‰²ï¼ŒåŠ å…¥ loading æ•ˆæœã€‚</li>
<li>4 å¯ä»¥é€šè¿‡ ref æ¥è·å–åŸå§‹ç»„ä»¶å®ä¾‹ï¼Œæ“ä½œå®ä¾‹ä¸‹çš„å±æ€§å’Œæ–¹æ³•ã€‚</li>
<li>5 å¯ä»¥å¯¹åŸå§‹ç»„ä»¶åšä¸€äº›äº‹ä»¶ç›‘å¬ï¼Œé”™è¯¯ç›‘æ§ç­‰ã€‚</li>
</ul>
<h2>å›› é«˜ä»·ç»„ä»¶æ³¨æ„äº‹é¡¹</h2>
<h3>1 è°¨æ…ä¿®æ”¹åŸå‹é“¾</h3>
<pre><code class="hljs language-js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">HOC</span> (<span class="hljs-params">Component</span>)</span>{
  <span class="hljs-keyword">const</span> proDidMount = Component.prototype.componentDidMount 
  Component.prototype.componentDidMount = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
     <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'åŠ«æŒç”Ÿå‘½å‘¨æœŸï¼šcomponentDidMount'</span>)
     proDidMount.call(<span class="hljs-built_in">this</span>)
  }
  <span class="hljs-keyword">return</span>  Component
}
</code></pre>
<p>å¦‚ä¸Š HOC ä½œç”¨ä»…ä»…æ˜¯ä¿®æ”¹äº†åŸæ¥ç»„ä»¶åŸå‹é“¾ä¸Šçš„ componentDidMount ç”Ÿå‘½å‘¨æœŸã€‚ä½†æ˜¯è¿™æ ·æœ‰ä¸€ä¸ªå¼Šç«¯å°±æ˜¯å¦‚æœå†ç”¨å¦å¤–ä¸€ä¸ª HOC ä¿®æ”¹åŸå‹é“¾ä¸Šçš„ componentDidMount ï¼Œé‚£ä¹ˆè¿™ä¸ªHOCçš„åŠŸèƒ½å³å°†å¤±æ•ˆã€‚</p>
<h3>2 ä¸è¦åœ¨å‡½æ•°ç»„ä»¶å†…éƒ¨æˆ–ç±»ç»„ä»¶renderå‡½æ•°ä¸­ä½¿ç”¨HOC</h3>
<p>ç±»ç»„ä»¶ä¸­ğŸ™…é”™è¯¯å†™æ³•ï¼š</p>
<pre><code class="hljs language-js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Index</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span></span>{
  <span class="hljs-function"><span class="hljs-title">render</span>(<span class="hljs-params"></span>)</span>{
     <span class="hljs-keyword">const</span> WrapHome = HOC(Home)
     <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">WrapHome</span> /></span></span>
  }
}
</code></pre>
<p>å‡½æ•°ç»„ä»¶ä¸­ğŸ™…é”™è¯¯å†™æ³•ï¼š</p>
<pre><code class="hljs language-js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Index</span>(<span class="hljs-params"></span>)</span>{
     <span class="hljs-keyword">const</span> WrapHome = HOC(Home)
     <span class="hljs-keyword">return</span>  <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">WrapHome</span> /></span></span>
}
</code></pre>
<p>è¿™ä¹ˆå†™çš„è¯æ¯ä¸€æ¬¡ç±»ç»„ä»¶è§¦å‘ render æˆ–è€…å‡½æ•°ç»„ä»¶æ‰§è¡Œéƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„WrapHomeï¼Œ<code>react diff</code> ä¼šåˆ¤å®šä¸¤æ¬¡ä¸æ˜¯åŒä¸€ä¸ªç»„ä»¶ï¼Œé‚£ä¹ˆå°±ä¼šå¸è½½è€ç»„ä»¶ï¼Œé‡æ–°æŒ‚è½½æ–°ç»„ä»¶ï¼Œè€ç»„ä»¶å†…éƒ¨çš„çœŸå® DOM èŠ‚ç‚¹ï¼Œéƒ½ä¸ä¼šåˆç†çš„å¤ç”¨ï¼Œä»è€Œé€ æˆäº†æ€§èƒ½çš„æµªè´¹ï¼Œè€Œä¸”åŸå§‹ç»„ä»¶ä¼šè¢«åˆå§‹åŒ–å¤šæ¬¡ã€‚</p>
<h3>3 refçš„å¤„ç†</h3>
<p>é«˜é˜¶ç»„ä»¶çš„çº¦å®šæ˜¯å°†æ‰€æœ‰ props ä¼ é€’ç»™è¢«åŒ…è£…ç»„ä»¶ï¼Œä½†è¿™å¯¹äº ref å¹¶ä¸é€‚ç”¨ã€‚é‚£æ˜¯å› ä¸º ref å®é™…ä¸Šå¹¶ä¸æ˜¯ä¸€ä¸ª prop ï¼Œ å°±åƒ key ä¸€æ ·ï¼Œå¯¹äº ref å±æ€§å®ƒæ˜¯ç”± React ä¸“é—¨å¤„ç†çš„ã€‚é‚£ä¹ˆå¦‚ä½•é€šè¿‡ ref æ­£å¸¸è·å–åˆ°åŸå§‹ç»„ä»¶çš„å®ä¾‹å‘¢ï¼Ÿåœ¨ ref ç« èŠ‚å·²ç»è®²åˆ°ï¼Œå¯ä»¥ç”¨ <code>forwardRef</code>åš ref çš„è½¬å‘å¤„ç†ã€‚</p>
<h3>4 æ³¨æ„å¤šä¸ªHOCåµŒå¥—é¡ºåºé—®é¢˜</h3>
<p>å¤šä¸ªHOCåµŒå¥—ï¼Œåº”è¯¥ç•™æ„ä¸€ä¸‹HOCçš„é¡ºåºï¼Œè¿˜è¦åˆ†æå‡ºè¦å„ä¸ª HOC ä¹‹é—´æ˜¯å¦æœ‰ä¾èµ–å…³ç³»ã€‚</p>
<p>å¯¹äº class å£°æ˜çš„ç±»ç»„ä»¶ï¼Œå¯ä»¥ç”¨è£…é¥°å™¨æ¨¡å¼ï¼Œå¯¹ç±»ç»„ä»¶è¿›è¡ŒåŒ…è£…ï¼š</p>
<pre><code class="hljs language-js">@HOC1(styles)
@HOC2
@HOC3
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Index</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Componen</span></span>{
    <span class="hljs-comment">/* ... */</span>
}
</code></pre>
<p>å¯¹äºå‡½æ•°ç»„ä»¶ï¼š</p>
<pre><code class="hljs language-js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Index</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-comment">/* .... */</span>
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> HOC1(styles)(HOC2( HOC3(Index) )) 
</code></pre>
<p>HOC1 -> HOC2 -> HOC3 -> Index</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/553a203098134c5abf734f4104ab4d14~tplv-k3u1fbpfcp-watermark.image" alt="hoc1.jpg"></p>
<p><strong>è¦æ³¨æ„ä¸€ä¸‹åŒ…è£…é¡ºåºï¼Œè¶Šé è¿‘ <code>Index</code> ç»„ä»¶çš„ï¼Œå°±æ˜¯è¶Šå†…å±‚çš„ HOC ,ç¦»ç»„ä»¶ <code>Index</code> ä¹Ÿå°±è¶Šè¿‘ã€‚</strong></p>
<p>è¿˜æœ‰ä¸€äº›å…¶ä»–çš„å°ç»†èŠ‚ï¼š</p>
<ul>
<li>
<p>1 å¦‚æœ2ä¸ª HOC ç›¸äº’ä¹‹é—´æœ‰ä¾èµ–ã€‚æ¯”å¦‚ HOC1 ä¾èµ– HOC2 ï¼Œé‚£ä¹ˆ HOC1 åº”è¯¥åœ¨ HOC2 å†…éƒ¨ã€‚</p>
</li>
<li>
<p>2 å¦‚æœæƒ³é€šè¿‡ HOC æ–¹å¼ç»™åŸå§‹ç»„ä»¶æ·»åŠ ä¸€äº›é¢å¤–ç”Ÿå‘½å‘¨æœŸï¼Œå› ä¸ºæ¶‰åŠåˆ°è·å–åŸå§‹ç»„ä»¶çš„å®ä¾‹ instance ï¼Œé‚£ä¹ˆå½“å‰çš„ HOC è¦ç¦»åŸå§‹ç»„ä»¶æœ€è¿‘ã€‚</p>
</li>
</ul>
<h3>5 ç»§æ‰¿é™æ€å±æ€§</h3>
<p>ä¸Šè¿°è®²åˆ°åœ¨å±æ€§ä»£ç† HOC æœ¬è´¨ä¸Šè¿”å›äº†ä¸€ä¸ªæ–°çš„ component ï¼Œé‚£ä¹ˆå¦‚æœç»™åŸæ¥çš„ component ç»‘å®šä¸€äº›é™æ€å±æ€§æ–¹æ³•ï¼Œå¦‚æœä¸å¤„ç†ï¼Œæ–°çš„ component ä¸Šå°±ä¼šä¸¢å¤±è¿™äº›é™æ€å±æ€§æ–¹æ³•ã€‚é‚£ä¹ˆå¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ã€‚</p>
<p><strong>æ‰‹åŠ¨ç»§æ‰¿</strong></p>
<p>å½“ç„¶å¯ä»¥æ‰‹åŠ¨å°†åŸå§‹ç»„ä»¶çš„é™æ€æ–¹æ³• copy åˆ° HOC ç»„ä»¶ä¸Šæ¥ï¼Œä½†å‰ææ˜¯å¿…é¡»å‡†ç¡®çŸ¥é“åº”è¯¥æ‹·è´å“ªäº›æ–¹æ³•ã€‚</p>
<pre><code class="hljs language-js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">HOC</span>(<span class="hljs-params">Component</span>) </span>{
  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WrappedComponent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
      <span class="hljs-comment">/*...*/</span>
  }
  <span class="hljs-comment">// å¿…é¡»å‡†ç¡®çŸ¥é“åº”è¯¥æ‹·è´å“ªäº›æ–¹æ³• </span>
  WrappedComponent.staticMethod = Component.staticMethod
  <span class="hljs-keyword">return</span> WrappedComponent
}
</code></pre>
<p><strong>å¼•å…¥ç¬¬ä¸‰æ–¹åº“</strong></p>
<p>æ¯ä¸ªé™æ€å±æ€§æ–¹æ³•éƒ½æ‰‹åŠ¨ç»‘å®šä¼šå¾ˆç´¯ï¼Œå°¤å…¶å¯¹äºå¼€æºçš„ HOC ï¼Œå¯¹åŸç”Ÿç»„ä»¶çš„é™æ€æ–¹æ³•æ˜¯æœªçŸ¥ ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜å¯ä»¥ä½¿ç”¨ <code>hoist-non-react-statics</code> è‡ªåŠ¨æ‹·è´æ‰€æœ‰çš„é™æ€æ–¹æ³•:</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">import</span> hoistNonReactStatic <span class="hljs-keyword">from</span> <span class="hljs-string">'hoist-non-react-statics'</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">HOC</span>(<span class="hljs-params">Component</span>) </span>{
  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WrappedComponent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
      <span class="hljs-comment">/*...*/</span>
  }
  hoistNonReactStatic(WrappedComponent,Component)
  <span class="hljs-keyword">return</span> WrappedComponent
}
</code></pre>
<h2>äº” è¿›é˜¶å®è·µ-æƒé™æ‹¦æˆª</h2>
<p>ä¸‹é¢è§£å†³åˆšå¼€å§‹å°æ˜é‡åˆ°çš„æƒé™æ‹¦æˆªé—®é¢˜ã€‚å…·ä½“å¯ä»¥å‚è€ƒå¦‚ä¸‹ demo ï¼Œæ²¡æœ‰ç»‘å®šæ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d07a81733e1344d4b4773934cd0f19d4~tplv-k3u1fbpfcp-watermark.image" alt="hoc6.gif"></p>
<p>å‡è®¾æœŸæœ›çš„æ•ˆæœæ˜¯ï¼š</p>
<ul>
<li>1 å°†æ–‡æ¡£ç®¡ç†å’Œæ ‡ç­¾ç®¡ç†æ¨¡å—ï¼Œé…ç½®æˆæƒé™æ‹¦æˆªçš„é¡µé¢ã€‚</li>
<li>2 æ¨¡æ‹Ÿæ•°æ®äº¤äº’ï¼Œè¿”å›æ¨¡æ‹Ÿæ•°æ®æ‹¦æˆªæ–‡æ¡£å½•å…¥å’Œæ ‡ç­¾å½•å…¥ä¸¤ä¸ªé¡µé¢ã€‚ï¼ˆå› ä¸ºè¿™èŠ‚ä¸»è¦è®² HOC ï¼Œæ‰€ä»¥ä¸å¿…è¿‡å¤šåœ¨æ„å…¶ä»–ç»†èŠ‚ï¼‰</li>
</ul>
<p>æ€è·¯ï¼š</p>
<ul>
<li>1 éœ€è¦æƒé™çš„é¡µé¢æˆ–è€…ç»„ä»¶ï¼Œç”¨ HOC åŒ…è£¹ï¼Œå¹¶è¾“å…¥å”¯ä¸€çš„æƒé™ç­¾åã€‚</li>
<li>2 ç”¨ Context ä¸Šä¸‹æ–‡ä¿å­˜å…¨å±€çš„æƒé™èœå•åˆ—è¡¨ï¼Œç”¨ Provider æ³¨å…¥å¼‚æ­¥è·å–åˆ°çš„æƒé™èœå•ã€‚</li>
<li>3 HOC ä¸­ç”¨ Consumer è·å–æƒé™åˆ—è¡¨ï¼Œå¹¶ä¸”å’Œç­¾ååšåŒ¹é…ï¼Œå¦‚æœæœ‰æƒé™ï¼Œå°±å±•ç¤ºï¼Œå¦‚æœæ²¡æœ‰æƒé™ï¼Œå±•ç¤ºé»˜è®¤æ²¡æœ‰æƒé™ç»„ä»¶ã€‚</li>
</ul>
<p><strong>ç¬¬ä¸€æ­¥ï¼Œåœ¨æ ¹éƒ¨æ³¨å…¥æƒé™ã€‚</strong></p>
<pre><code class="hljs language-js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> Permission = React.createContext([]) 

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Index</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">const</span> [ rootPermission , setRootPermission ] = React.useState([])
    React.useEffect(<span class="hljs-function">()=></span>{
        <span class="hljs-comment">/* è·å–æƒé™åˆ—è¡¨ */</span>
        getRootPermission().then(<span class="hljs-function"><span class="hljs-params">res</span>=></span>{
            <span class="hljs-keyword">const</span> { code , data } = res <span class="hljs-keyword">as</span> any
            code === <span class="hljs-number">200</span> &#x26;&#x26; setRootPermission(data) <span class="hljs-comment">//  [ 'docList'  , 'tagList' ]</span>
        }) 
    },[])
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">Permission.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{rootPermission}</span> ></span>
         <span class="hljs-tag">&#x3C;<span class="hljs-name">RootRouter</span>/></span>
    <span class="hljs-tag">&#x3C;/<span class="hljs-name">Permission.Provider</span>></span></span>
}

</code></pre>
<ul>
<li>useState ç”¨äºåŠ¨æ€æ³¨å…¥è·å–çš„æƒé™åˆ—è¡¨ã€‚</li>
<li>æ ¹ç»„ä»¶é€šè¿‡ Context.Provider åŒ…è£¹ã€‚æƒé™åˆ—è¡¨æ”¹å˜ï¼Œæ‰€æœ‰æ¶ˆè´¹æƒé™åˆ—è¡¨çš„ç»„ä»¶é‡æ–°æ›´æ–°ã€‚</li>
</ul>
<p>ï¼ˆå‡è®¾ä¸€ä¸‹æ•°æ®äº¤äº’è¿”å›çš„æƒé™åˆ—è¡¨<code>[ 'docList'  , 'tagList' ]</code>ï¼‰</p>
<p><strong>ç¬¬äºŒæ­¥ï¼šé‡ç‚¹ç¼–å†™HOC</strong></p>
<pre><code class="hljs language-js"><span class="hljs-comment">/* æ²¡æœ‰æƒé™ */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">NoPermission</span> (<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">div</span>></span>æ‚¨æš‚æ—¶æ²¡æœ‰æƒé™ï¼Œè¯·è”ç³»ç®¡ç†å‘˜å¼€é€šæƒé™ï¼<span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span></span>
}
<span class="hljs-comment">/* ç¼–å†™HOC */</span>
<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">PermissionHoc</span>(<span class="hljs-params">authorization</span>)</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">Component</span>)</span>{ 
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Home</span> (<span class="hljs-params">props</span>)</span>{
            <span class="hljs-keyword">const</span> matchPermission =<span class="hljs-function">(<span class="hljs-params">value,list</span>)=></span> list.indexOf(value) <span class="hljs-comment">/* åŒ¹é…æƒé™ */</span>
            <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">Permission.Consumer</span>></span>
                {
                    (permissionList) => matchPermission(authorization,permissionList) >= 0 ? <span class="hljs-tag">&#x3C;<span class="hljs-name">Component</span>  {<span class="hljs-attr">...props</span>} /></span> : <span class="hljs-tag">&#x3C;<span class="hljs-name">NoPermission</span> /></span>
                }
            <span class="hljs-tag">&#x3C;/<span class="hljs-name">Permission.Consumer</span>></span></span>
        }
    }
}
</code></pre>
<p>HOC ç¼–å†™ï¼š</p>
<ul>
<li>1 ç”¨ä¸¤å±‚åŒ…è£…å‡½æ•°çš„ HOCï¼Œç¬¬ä¸€å±‚ç”¨äºè·å– HOC ç»‘å®šçš„å½“å‰ç»„ä»¶çš„æƒé™ç­¾åï¼Œå› ä¸ºè¦ç”¨è¿™ä¸ªæƒé™ç­¾åå’Œæƒé™åˆ—è¡¨åšåŒ¹é…ã€‚ç¬¬äºŒå±‚æ¥å—çš„åŸå§‹ç»„ä»¶ã€‚</li>
<li>2 åœ¨ HOC ä¸­ç”¨ Context.Consumer æ¥æ”¶æƒé™åˆ—è¡¨ï¼Œåšæƒé™åŒ¹é…ã€‚ç»„ä»¶æœ‰æƒé™å±•ç¤ºï¼Œæ²¡æœ‰æƒé™å±•ç¤ºæ— æƒé™ç»„ä»¶ã€‚</li>
</ul>
<p><strong>ç¬¬ä¸‰éƒ¨ï¼šç»‘å®šæƒé™</strong></p>
<pre><code class="hljs language-js">@PermissionHoc(<span class="hljs-string">'writeDoc'</span>)  <span class="hljs-comment">// ç»‘å®šæ–‡æ¡£å½•å…¥é¡µé¢</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Index</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span></span>{}
</code></pre>
<pre><code class="hljs language-js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> PermissionHoc(<span class="hljs-string">'writeTag'</span>)(index) <span class="hljs-comment">//ç»‘å®šæ ‡ç­¾å½•å…¥é¡µé¢</span>
</code></pre>
<pre><code class="hljs language-js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> PermissionHoc(<span class="hljs-string">'tagList'</span>)(index) <span class="hljs-comment">//ç»‘å®šæ ‡ç­¾åˆ—è¡¨é¡µé¢</span>
</code></pre>
<pre><code class="hljs language-js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> PermissionHoc(<span class="hljs-string">'docList'</span>)(Index) <span class="hljs-comment">// ç»‘å®šæ–‡æ¡£åˆ—è¡¨é¡µé¢</span>
</code></pre>
<ul>
<li>å¯¹äºä¸šåŠ¡ç»„ä»¶è¿›è¡Œæƒé™ HOC çš„åŒ…è£¹ã€‚</li>
</ul>
<p>å› ä¸ºä¸Šè¿°æ¨¡æ‹Ÿæ•°æ®è¿”å›çš„æ˜¯<code>[ 'docList'  , 'tagList' ]</code>ï¼Œæ‰€ä»¥æœ€ç»ˆåªèƒ½çœ‹åˆ° æ ‡ç­¾åˆ—è¡¨ å’Œ æ–‡æ¡£åˆ—è¡¨ é¡µé¢ã€‚</p>
<p><strong>ç¬¬å››éƒ¨ï¼šéªŒè¯æ•ˆæœ</strong></p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/469ab81641774cf0943445f801522c9f~tplv-k3u1fbpfcp-watermark.image" alt="hoc7.gif"></p>
<p>å®Œç¾å®ç°æ•ˆæœï¼Œæ­£å¸¸å¼€å‘å¯èƒ½è€ƒè™‘çš„å› ç´ è¦æ¯” demo ä¸­çš„å¤šï¼Œdemo å®è·µç»™å¤§å®¶æä¾›ä¸€ä¸ªæ€è·¯ï¼Œå…·ä½“å®ç°è¿˜è¦çœ‹å…·ä½“çš„ä¸šåŠ¡éœ€æ±‚ã€‚</p>
<h2>å…­æ€»ç»“</h2>
<p>è¿™èŠ‚ä¸»è¦å­¦ä¹ äº†ï¼š</p>
<ul>
<li>1 HOC è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Œè¯ç”Ÿçš„åˆè¡·ï¼Œä¸¤ç§ä¸åŒçš„ HOC ã€‚</li>
<li>2 å¦‚ä½•ç¼–å†™ HOC ã€‚</li>
<li>3 ç¼–å†™ HOC çš„æ³¨æ„äº‹é¡¹ã€‚</li>
<li>4 HOC å®ç°æƒé™éš”ç¦»çš„å®è·µã€‚</li>
</ul>
<p>ä¸‹ä¸€èŠ‚ï¼Œå°†ä¸€èµ·è¿›å…¥Reactä¼˜åŒ–ç¯‡.</p></div>
</body></html>
<!DOCTYPE html><html lang="en"><head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç¬¬ 01 è®²ï¼šè®¾è®¡ä¸€ä»½å¸å¼•é¢è¯•å®˜çš„ç®€å†</title>
<style type="text/css">
:root {
    --control-text-color: #777;
    --select-text-bg-color: rgba(223, 197, 223);  /*#7e66992e;*/
    
    /* side bar */
    --side-bar-bg-color: rgb(255, 255, 255);
    --active-file-text-color: #8163bd;
    --active-file-bg-color: #E9E4F0;
    --item-hover-bg-color: #E9E4F0;
    --active-file-border-color: #8163bd;

    --title-color: #6c549c;
    --font-sans-serif: 'Ubuntu', 'Source Sans Pro', sans-serif !important;
    --font-monospace: 'Fira Code', 'Roboto Mono', monospace !important;
    --purple-1: #8163bd;
    --purple-2: #79589F;
    --purple-3: #fd5eb8;
    --purple-light-1: rgba(99, 99, 172, .05);
    --purple-light-2: rgba(99, 99, 172, .1);
    --purple-light-3: rgba(99, 99, 172, .2);
    --purple-light-4: rgba(129, 99, 189, .3);
    --purple-light-5: #E9E4F0;
    --purple-light-6: rgba(129, 99, 189, .8);
}

/* html {
    font-size: 16px;
} */

body {
    font-family: var(--font-sans-serif);
    color: #34495e;
    -webkit-font-smoothing: antialiased;
    line-height: 1.6rem;
    letter-spacing: 0;
    margin: 0;
    overflow-x: hidden;
}

/* é¡µè¾¹è· å’Œ é¡µé¢å¤§å° */
#write {
    padding-left: 6ch;
    padding-right: 6ch;
    margin: 0 auto;
}

#write p {
    line-height: 1.6rem;
    word-spacing: .05rem;
}

#write ol li {
    padding-left: 0.5rem;
}

#write > ul:first-child,
#write > ol:first-child {
    margin-top: 30px;
}

body > *:first-child {
    margin-top: 0 !important;
}

body > *:last-child {
    margin-bottom: 0 !important;
}

a {
    color: var(--purple-1);
    padding: 0 2px;
    text-decoration: none;
}
.md-content {
    color: var(--purple-light-6);
}
#write a {
    border-bottom: 1px solid var(--purple-1);
    color: var(--purple-1);
    text-decoration: none;
}

h1,
h2,
h3,
h4,
h5,
h6 {
    position: relative;
    margin-top: 1rem;
    margin-bottom: 0.5rem;
    /* font-weight: bold; */
    font-weight: 500 !important;
    line-height: 1.4;
    cursor: text;
    color: var(--title-color);
    font-family: var(--font-sans-serif);
}

h1:hover a.anchor,
h2:hover a.anchor,
h3:hover a.anchor,
h4:hover a.anchor,
h5:hover a.anchor,
h6:hover a.anchor {
    text-decoration: none;
}

h1 tt,
h1 code {
    font-size: inherit !important;
}
h2 tt,
h2 code {
    font-size: inherit !important;
}
h3 tt,
h3 code {
    font-size: inherit !important;
}
h4 tt,
h4 code {
    font-size: inherit !important;
}
h5 tt,
h5 code {
    font-size: inherit !important;
}
h6 tt,
h6 code {
    font-size: inherit !important;
}


h1 {
    padding-bottom: .4rem;
    font-size: 2.2rem;
    line-height: 1.3;
}
h1 {
    text-align: center;
    padding-bottom: 0.3em;
    font-size: 2.2em;
    line-height: 1.2;
    margin: 2.4em auto 1.2em;
}
h1:after {
    content: '';
    display: block;
    margin: 0.2em auto 0;
    width: 100px;
    height: 2px;
    border-bottom: 2px solid var(--title-color);
}

h2 {
    margin: 1.6em auto 0.5em;
    padding-left: 10px;
    line-height: 1.4;
    font-size: 1.8em;
    border-left: 9px solid var(--title-color);
    border-bottom: 1px solid var(--title-color);
}
h3 {
    font-size: 1.5rem;
    margin: 1.2em auto 0.5em;
}
h4 {
    font-size: 1.3rem;
}
h5 {
    font-size: 1.2rem;
}
h6 {
    font-size: 1.1rem;
}

p,
blockquote,
ul,
ol,
dl,
table {
    margin: 0.8em 0;
}

li > ol,
li > ul {
    margin: 0 0;
}

hr {
    height: 2px;
    padding: 0;
    margin: 16px 0;
    background-color: #e7e7e7;
    border: 0 none;
    overflow: hidden;
    box-sizing: content-box;
}

body > h2:first-child {
    margin-top: 0;
    padding-top: 0;
}

body > h1:first-child {
    margin-top: 0;
    padding-top: 0;
}

body > h1:first-child + h2 {
    margin-top: 0;
    padding-top: 0;
}

body > h3:first-child,
body > h4:first-child,
body > h5:first-child,
body > h6:first-child {
    margin-top: 0;
    padding-top: 0;
}

a:first-child h1,
a:first-child h2,
a:first-child h3,
a:first-child h4,
a:first-child h5,
a:first-child h6 {
    margin-top: 0;
    padding-top: 0;
}

h1 p,
h2 p,
h3 p,
h4 p,
h5 p,
h6 p {
    margin-top: 0;
}

li p.first {
    display: inline-block;
}

ul,
ol {
    padding-left: 30px;
}

ul:first-child,
ol:first-child {
    margin-top: 0;
}

ul:last-child,
ol:last-child {
    margin-bottom: 0;
}

/* å¼•ç”¨ */
blockquote {
    /* margin-left: 1rem; */
    border-left: 4px solid var(--purple-light-4);
    padding: 10px 15px;
    color: #777;
    background-color: var(--purple-light-1);
}

/* è¡¨æ ¼ */
table {
    padding: 0;
    word-break: initial;
}

table tr {
    border-top: 1px solid #dfe2e5;
    margin: 0;
    padding: 0;
}

/* è¡¨æ ¼ èƒŒæ™¯è‰² */
table tr:nth-child(2n),
thead {
    background-color: var(--purple-light-1);
}
#write table thead th {
    background-color: var(--purple-light-2);
}

table tr th {
    font-weight: bold;
    border: 1px solid #dfe2e5;
    border-bottom: 0;
    text-align: left;
    margin: 0;
    padding: 6px 13px;
}

table tr td {
    border: 1px solid #dfe2e5;
    text-align: left;
    margin: 0;
    padding: 6px 13px;
}

table tr th:first-child,
table tr td:first-child {
    margin-top: 0;
}

table tr th:last-child,
table tr td:last-child {
    margin-bottom: 0;
}

/* ç²—ä½“ */
#write strong {
    padding: 0 2px;
    color: var(--purple-1);
}

/* æ–œä½“ */
#write em {
    padding: 0 5px 0 2px;
    /* font-style: normal; */
    color: #42b983;
}

/* inline code */
#write code, tt {
    padding: 2px 4px;
    border-radius: 2px;
    font-family: var(--font-monospace);
    font-size: 0.92rem;
    color: var(--purple-3); 
    background-color: rgba(99, 99, 172, .05);
}

tt {
    margin: 0 2px;
}

#write .md-footnote {
    background-color: #f8f8f8;
    color: var(--purple-3);
}

/* heighlight. */
#write mark {
    background-color: #fbd3ea;
    border-radius: 2px;
    padding: 2px 4px;
    margin: 0 2px;
}

#write del {
    padding: 1px 2px;
}

.md-task-list-item > input {
    margin-left: -1.3em;
}

@media print {
    html {
        font-size: 0.9rem;
    }

    table,
    pre {
        page-break-inside: avoid;
    }

    pre {
        word-wrap: break-word;
    }
}

#write pre.md-meta-block {
    padding: 1rem;
    font-size: 85%;
    line-height: 1.45;
    background-color: #f7f7f7;
    border: 0;
    border-radius: 3px;
    color: #777777;
    margin-top: 0 !important;
}

.mathjax-block > .code-tooltip {
    bottom: .375rem;
}

/* å›¾ç‰‡ */
.md-image > .md-meta {
    border-radius: 3px;
    font-family: var(--font-monospace);
    padding: 2px 0 0 4px;
    font-size: 0.9em;
    color: inherit;
}
p .md-image:only-child{
    width: auto;
    text-align: left;
    margin-left: 2rem;
}
.md-tag {
    color: inherit;
}
/* å½“ â€œ![shadow-éšä¾¿å†™]()â€å†™æ—¶ï¼Œä¼šæœ‰é˜´å½± */
.md-image img[alt|='shadow'] {
    /* box-shadow: 0 4px 24px -6px #ddd; */
    box-shadow:var(--purple-light-2) 0px 10px 15px;
}

#write a.md-toc-inner {
    line-height: 1.6;
    white-space: pre-line;
    border-bottom: none;
    font-size: 0.9rem;
}

#typora-quick-open {
    border: 1px solid #ddd;
    background-color: #f8f8f8;
}

#typora-quick-open-item {
    background-color: #FAFAFA;
    border-color: #FEFEFE #e5e5e5 #e5e5e5 #eee;
    border-style: solid;
    border-width: 1px;
}

#md-notification:before {
    top: 10px;
}

header,
.context-menu,
.megamenu-content,
footer {
    font-family: var(--font-sans-serif);
}

.file-node-content:hover .file-node-icon,
.file-node-content:hover .file-node-open-state {
    visibility: visible;
}

.md-lang {
    color: #b4654d;
}

.html-for-mac .context-menu {
    --item-hover-bg-color: #E6F0FE;
}

/* ä»£ç æ¡† */
/* CodeMirror 3024 Day theme */

/* ä»£ç æ®µ èƒŒæ™¯ */
pre {
    --select-text-bg-color: rgba(223, 197, 223) !important;
    margin: .5em 0;
    padding: 1em 1.4em;
    border-radius: 8px;
    background: #f6f8fa;
    overflow-x: auto;
    box-sizing: border-box;
    font-size: 14px;
}

/* è¾¹æ¡† */
.md-fences {
    border: 1px solid #e7eaed;
    border-radius: 3px;
}

.cm-s-inner {
  padding: .25rem;
  border-radius: .25rem;
}

.cm-s-inner.CodeMirror, .cm-s-inner .CodeMirror-gutters {
  background-color: #f8f8f8 !important;
  color: #3a3432 !important;
  border: none;
}

.cm-s-inner .CodeMirror-gutters {
  color: #6d8a88;
}

.cm-s-inner .CodeMirror-cursor {
  border-left: solid thin #5c5855 !important;
}

.cm-s-inner .CodeMirror-linenumber {
  color: #807d7c;
}

.cm-s-inner .CodeMirror-line::selection, .cm-s-inner .CodeMirror-line::-moz-selection,
.cm-s-inner .CodeMirror-line > span::selection,
.cm-s-inner .CodeMirror-line > span::-moz-selection,
.cm-s-inner .CodeMirror-line > span > span::selection,
.cm-s-inner .CodeMirror-line > span > span::-moz-selection {
  background: var(--purple-light-2);
}

.cm-s-inner span.cm-comment {
  color: #cdab53;
}

.cm-s-inner span.cm-string, .cm-s-inner span.cm-string-2 {
  color: #f2b01d;
}

.cm-s-inner span.cm-number {
  color: #a34e8f;
}

.cm-s-inner span.cm-variable {
  color: #01a252;
}

.cm-s-inner span.cm-variable-2 {
  color: #01a0e4;
}

.cm-s-inner span.cm-def {
  /* color: #e8bbd0; */
  color: #e2287f;
}

.cm-s-inner span.cm-operator {
  color: #ff79c6;
}

.cm-s-inner span.cm-keyword {
  color: #db2d20;
}

.cm-s-inner span.cm-atom {
  color: #a34e8f;
}

.cm-s-inner span.cm-meta {
  color: inherit;
}

.cm-s-inner span.cm-tag {
  color: #db2d20;
}

.cm-s-inner span.cm-attribute {
  color: #01a252;
}

.cm-s-inner span.cm-qualifier {
  color: #388aa3;
}

.cm-s-inner span.cm-property {
  color: #01a252;
}

.cm-s-inner span.cm-builtin {
  color: #388aa3;
}

.cm-s-inner span.cm-variable-3, .cm-s-inner span.cm-type {
  color: #ffb86c;
}

.cm-s-inner span.cm-bracket {
  color: #3a3432;
}

.cm-s-inner span.cm-link {
  color: #a34e8f;
}

.cm-s-inner span.cm-error {
  background: #db2d20;
  color: #5c5855;
}

/* .md-fences.md-focus .cm-s-inner .CodeMirror-activeline-background {
  background: var(--purple-light-2);
} */

.cm-s-inner .CodeMirror-matchingbracket {
  text-decoration: underline;
  color: #a34e8f !important;
}

#fences-auto-suggest .active {
  background: #ddd;
}

#write .code-tooltip {
  bottom: initial;
  top: calc(100% - 1px);
  background: #f7f7f7;
  border: 1px solid #ddd;
  border-top: 0;
}

.auto-suggest-container {
  border-color: #b4b4b4;
}

.auto-suggest-container .autoComplt-hint.active {
  background: #b4b4b4;
  color: inherit;
}

/* task list */
#write .md-task-list-item > input {
  -webkit-appearance: initial;
  display: block;
  position: absolute;
  border: 1px solid #b4b4b4;
  border-radius: .25rem;
  margin-top: .1rem;
  margin-left: -1.8rem;
  height: 1.2rem;
  width: 1.2rem;
  transition: background 0.3s;
}

#write .md-task-list-item > input:focus {
  outline: none;
  box-shadow: none;
}

#write .md-task-list-item > input:hover {
  background: #ddd;
}

#write .md-task-list-item > input[checked]::before {
  content: '';
  position: absolute;
  top: 20%;
  left: 50%;
  height: 60%;
  width: 2px;
  transform: rotate(40deg);
  background: #333;
}

#write .md-task-list-item > input[checked]::after {
  content: '';
  position: absolute;
  top: 46%;
  left: 25%;
  height: 30%;
  width: 2px;
  transform: rotate(-40deg);
  background: #333;
}

#write .md-task-list-item > p {
  transition: color 0.3s, opacity 0.3s;
}

#write .md-task-list-item.task-list-done > p {
  color: #b4b4b4;
  text-decoration: line-through;
}

#write .md-task-list-item.task-list-done > p > .md-emoji {
  opacity: .5;
}

#write .md-task-list-item.task-list-done > p > .md-link > a {
  opacity: .6;
}

/* sidebar and outline */
.pin-outline .outline-active {
  color: var(--active-file-text-color); 
}

.file-list-item {
    border-bottom: 1px solid;
    border-color: var(--purple-light-5);
}

.file-list-item-summary {
    font-weight: 400;
}

.file-list-item.active {
    color: var(--active-file-text-color);
    background-color: var(--purple-light-5);
}

.file-tree-node.active>.file-node-background {
    background-color: var(--purple-light-5);
    font-weight: 700;
} 

.file-tree-node.active>.file-node-content {
    color: var(--active-file-text-color);
    font-weight: 700;
}

.file-node-content {
    color: #5e676d;
}

.sidebar-tabs {
    border-bottom: none;
}
.sidebar-tab.active {
    font-weight: 400;
}

.sidebar-content-content {
    font-size: 0.9rem;
}

img {
    max-width: 100%;
}

body {
    background-color: rgb(237, 237, 237);
}
#content {
    width: 836px;
    padding: 50px;
    background: #fff;
    margin: 0 auto;
}/*# sourceURL=/Users/young/Documents/Codes/Fun/lagou/public/purple.css*/</style><style type="text/css">.hljs{display:block;overflow-x:auto;padding:.5em;color:#383a42;background:#fafafa}.hljs-comment,.hljs-quote{color:#a0a1a7;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e45649}.hljs-literal{color:#0184bb}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#50a14f}.hljs-built_in,.hljs-class .hljs-title{color:#c18401}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#4078f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}/*# sourceURL=/Users/young/Documents/Codes/Fun/lagou/public/atom-one-light.min.css*/</style></head>
<body>
<div id="content"><h1>åŸºç¡€ç¯‡-æä¾›è€… context</h1>
<h2>ä¸€ å‰è¨€</h2>
<p>æœ¬ç« èŠ‚ï¼Œæˆ‘ä»¬æ¥è°ˆè°ˆ<code> React context</code>ã€‚åœ¨æ­£å¼ä»‹ç»ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆæ¥æƒ³ä¸€æƒ³ä¸ºä»€ä¹ˆ React ä¼šæä¾› context çš„ API å‘¢ï¼Ÿ</p>
<p>å¸¦ç€è¿™ä¸ªç–‘é—®ï¼Œé¦–å…ˆå‡è®¾ä¸€ä¸ªåœºæ™¯ï¼šåœ¨ React çš„é¡¹ç›®æœ‰ä¸€ä¸ªå…¨å±€å˜é‡ themeï¼ˆ theme å¯èƒ½æ˜¯åˆå§‹åŒ–æ•°æ®äº¤äº’è·å¾—çš„ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯åˆ‡æ¢ä¸»é¢˜å˜åŒ–çš„ï¼‰ï¼Œæœ‰ä¸€äº›è§†å›¾ UI ç»„ä»¶ï¼ˆæ¯”å¦‚è¡¨å• input æ¡†ã€button æŒ‰é’®ï¼‰ï¼Œéœ€è¦ theme é‡Œé¢çš„å˜é‡æ¥åšå¯¹åº”çš„è§†å›¾æ¸²æŸ“ï¼Œç°åœ¨çš„é—®é¢˜æ˜¯æ€ä¹ˆèƒ½å¤ŸæŠŠ theme ä¼ é€’ä¸‹å»ï¼Œåˆç†åˆ†é…åˆ°<strong>ç”¨åˆ°è¿™ä¸ª theme</strong> çš„åœ°æ–¹ã€‚</p>
<p>é‚£ä¹ˆï¼Œé¦–å…ˆæƒ³åˆ°çš„æ˜¯ <strong>props çš„å¯è¡Œæ€§</strong>ï¼Œå¦‚æœè®© props æ¥è§£å†³ä¸Šè¿°é—®é¢˜å¯ä»¥æ˜¯å¯ä»¥ï¼Œä¸è¿‡ä¼šæœ‰ä¸¤ä¸ªé—®é¢˜ã€‚å‡è®¾é¡¹ç›®çš„ç»„ä»¶æ ‘æƒ…å†µå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå› ä¸ºåœ¨è®¾è®¡æ•´ä¸ªé¡¹ç›®çš„æ—¶å€™ï¼Œä¸ç¡®å®šå°†æ¥å“ªä¸€ä¸ªæ¨¡å—éœ€è¦ theme ï¼Œæ‰€ä»¥å¿…é¡»å°† theme åœ¨æ ¹ç»„ä»¶ A æ³¨å…¥ï¼Œä½†æ˜¯éœ€è¦ç»™ç»„ä»¶ N ä¼ é€’ props ï¼Œéœ€è¦åœ¨ä¸Šé¢æ¯ä¸€å±‚éƒ½å»æ‰‹åŠ¨ç»‘å®š props ï¼Œå¦‚æœå°†æ¥å…¶ä»–å­åˆ†æ”¯ä¸Šæœ‰æ›´æ·±å±‚çš„ç»„ä»¶éœ€è¦ theme ï¼Œè¿˜éœ€è¦æŠŠä¸Šä¸€çº§çš„ç»„ä»¶å…¨éƒ¨ç»‘å®šä¼ é€’ props ï¼Œè¿™æ ·ç»´æŠ¤æˆæœ¬æ˜¯å·¨å¤§çš„ã€‚</p>
<p>å‡è®¾éœ€è¦åŠ¨æ€æ”¹å˜ theme ï¼Œé‚£ä¹ˆéœ€è¦ä»æ ¹ç»„ä»¶æ›´æ–°ï¼Œåªè¦éœ€è¦ theme çš„ç»„ä»¶ï¼Œç”±å®ƒå¼€å§‹åˆ°æ ¹ç»„ä»¶çš„ä¸€æ¡ç»„ä»¶é“¾ç»“æ„éƒ½éœ€è¦æ›´æ–°ï¼Œä¼šé€ æˆç‰µä¸€å‘åŠ¨å…¨èº«çš„å½±å“ã€‚props æ–¹å¼çœ‹æ¥ä¸åˆ‡å®é™…ã€‚</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/198d518f80e7429880fdc99d6adab9de~tplv-k3u1fbpfcp-watermark.image" alt="context1.jpg"></p>
<p>ä¸ºäº†è§£å†³ä¸Šè¿° props ä¼ é€’çš„ä¸¤ä¸ªé—®é¢˜ï¼ŒReactæä¾›äº†contextâ€˜ä¸Šä¸‹æ–‡â€™æ¨¡å¼ï¼Œå…·ä½“æ¨¡å¼æ˜¯è¿™æ ·çš„ï¼ŒReactç»„ä»¶æ ‘AèŠ‚ç‚¹ï¼Œç”¨Provideræä¾›è€…æ³¨å…¥themeï¼Œç„¶ååœ¨éœ€è¦themeçš„åœ°æ–¹ï¼Œç”¨ Consumer æ¶ˆè´¹è€…å½¢å¼å–å‡ºthemeï¼Œä¾›ç»™ç»„ä»¶æ¸²æŸ“ä½¿ç”¨å³å¯ï¼Œè¿™æ ·å‡å°‘å¾ˆå¤šæ— ç”¨åŠŸã€‚ç”¨å®˜ç½‘ä¸Šçš„ä¸€å¥è¯å½¢å®¹å°±æ˜¯Context æä¾›äº†ä¸€ä¸ªæ— éœ€ä¸ºæ¯å±‚ç»„ä»¶æ‰‹åŠ¨æ·»åŠ  propsï¼Œå°±èƒ½åœ¨ç»„ä»¶æ ‘é—´è¿›è¡Œæ•°æ®ä¼ é€’çš„æ–¹æ³•ã€‚</p>
<p>ä½†æ˜¯å¿…é¡»æ³¨æ„ä¸€ç‚¹æ˜¯ï¼Œ<strong>æä¾›è€…æ°¸è¿œè¦åœ¨æ¶ˆè´¹è€…ä¸Šå±‚</strong>ï¼Œæ­£æ‰€è°“æ°´å¾€ä½å¤„æµï¼Œæä¾›è€…ä¸€å®šè¦æ˜¯æ¶ˆè´¹è€…çš„æŸä¸€å±‚çˆ¶çº§ã€‚</p>
<p>å¸Œæœ›é€šè¿‡æœ¬ç« èŠ‚å°†å­¦ä¼š React Context çš„åŸºç¡€ç”¨æ³•ï¼Œé«˜é˜¶ç”¨æ³•ï¼Œä»¥åŠ Context åˆ‡æ¢ä¸»é¢˜å®è·µã€‚è®©è¯»è¿‡çš„åŒå­¦ï¼Œèƒ½å¤Ÿæ˜ç™½ context ä½¿ç”¨åœºæ™¯ï¼Œä»¥åŠæ­£ç¡®ä½¿ç”¨ context ã€‚</p>
<h3>è€ç‰ˆæœ¬context</h3>
<p>åœ¨<code>v16.3.0</code>ä¹‹å‰ï¼ŒReact ç”¨ PropTypes æ¥å£°æ˜ context ç±»å‹ï¼Œæä¾›è€…éœ€è¦ getChildContext æ¥è¿”å›éœ€è¦æä¾›çš„ context ï¼Œå¹¶ä¸”ç”¨é™æ€å±æ€§  childContextTypes å£°æ˜éœ€è¦æä¾›çš„ context æ•°æ®ç±»å‹ã€‚å…·ä½“å¦‚ä¸‹</p>
<p><strong>è€ç‰ˆæœ¬æä¾›è€…</strong></p>
<pre><code class="hljs language-js"><span class="hljs-comment">// æä¾›è€…</span>
<span class="hljs-keyword">import</span> propsTypes <span class="hljs-keyword">from</span> <span class="hljs-string">'proptypes'</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProviderDemo</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span></span>{ 
    <span class="hljs-function"><span class="hljs-title">getChildContext</span>(<span class="hljs-params"></span>)</span>{
        <span class="hljs-keyword">const</span> theme = { <span class="hljs-comment">/* æä¾›è€…è¦æä¾›çš„ä¸»é¢˜é¢œè‰²ï¼Œä¾›æ¶ˆè´¹è€…æ¶ˆè´¹ */</span>
            <span class="hljs-attr">color</span>:<span class="hljs-string">'#ccc'</span>,
            <span class="hljs-attr">background</span>:<span class="hljs-string">'pink'</span>
        }
        <span class="hljs-keyword">return</span> { theme }
    }
    <span class="hljs-function"><span class="hljs-title">render</span>(<span class="hljs-params"></span>)</span>{
        <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">div</span>></span>
            hello,let us learn React!
            <span class="hljs-tag">&#x3C;<span class="hljs-name">Son</span>/></span>
        <span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span></span>
    }
 }

ProviderDemo.childContextTypes = {
    <span class="hljs-attr">theme</span>:propsTypes.object
}
</code></pre>
<p>è€ç‰ˆæœ¬ api åœ¨ v16 ç‰ˆæœ¬è¿˜èƒ½æ­£å¸¸ä½¿ç”¨ï¼Œå¯¹äºæä¾›è€…ï¼Œéœ€è¦é€šè¿‡ getChildContext æ–¹æ³•ï¼Œå°†ä¼ é€’çš„ theme ä¿¡æ¯è¿”å›å‡ºå»ï¼Œå¹¶é€šè¿‡ childContextTypes å£°æ˜è¦ä¼ é€’çš„ theme æ˜¯ä¸€ä¸ªå¯¹è±¡ç»“æ„ã€‚å£°æ˜ç±»å‹éœ€è¦<code>propsTypes</code>åº“æ¥åŠ©åŠ›ã€‚</p>
<p><strong>è€ç‰ˆæœ¬æ¶ˆè´¹è€…</strong></p>
<pre><code class="hljs language-js"><span class="hljs-comment">// æ¶ˆè´¹è€…</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConsumerDemo</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span></span>{
   <span class="hljs-function"><span class="hljs-title">render</span>(<span class="hljs-params"></span>)</span>{
       <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">this</span>.context.theme) <span class="hljs-comment">// {  color:'#ccc',  bgcolor:'pink' }</span>
       <span class="hljs-keyword">const</span> { color , background } = <span class="hljs-built_in">this</span>.context.theme
       <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">color</span>,<span class="hljs-attr">background</span> } } ></span>æ¶ˆè´¹è€…<span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span></span>
   }
}
ConsumerDemo.contextTypes = {
    <span class="hljs-attr">theme</span>:propsTypes.object
}

<span class="hljs-keyword">const</span> Son = <span class="hljs-function">()=></span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">ConsumerDemo</span>/></span></span>
</code></pre>
<p>æ•ˆæœï¼š</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4beb4f01370a427dbc3a040c101b7664~tplv-k3u1fbpfcp-watermark.image" alt="context2.jpg"></p>
<p>ä½œä¸ºæ¶ˆè´¹è€…ï¼Œéœ€è¦åœ¨ç»„ä»¶çš„é™æ€å±æ€§æŒ‡æ˜æˆ‘åˆ°åº•éœ€è¦å“ªä¸ªæä¾›è€…æä¾›çš„çŠ¶æ€ï¼Œåœ¨ demo é¡¹ç›®ä¸­ï¼ŒConsumerDemo çš„ contextTypes æ˜ç¡®çš„æŒ‡æ˜äº†éœ€è¦ ProviderDemo æä¾›çš„ themeä¿¡æ¯ï¼Œç„¶åå°±å¯ä»¥é€šè¿‡ this.context.theme è®¿é—®åˆ° theme ï¼Œç”¨åšæ¸²æŸ“æ¶ˆè´¹ã€‚</p>
<p>è¿™ç§æ¨¡å¼å’Œ vue ä¸­çš„ provide å’Œ inject æ•°æ®ä¼ è¾“æ¨¡å¼å¾ˆåƒï¼Œåœ¨æä¾›è€…ä¸­å£°æ˜åˆ°åº•ä¼ é€’ä»€ä¹ˆï¼Œç„¶åæ¶ˆè´¹è€…æŒ‡å‡ºéœ€è¦å“ªä¸ªæä¾›è€…æä¾›çš„ context ã€‚æ‰“ä¸ªæ¯”æ–¹ï¼Œå°±å¥½æ¯”å»ä¸€ä¸ªé«˜æ¡£é¤å…ï¼Œæ¯ä¸€ä¸ªå¨å¸ˆéƒ½å¯ä»¥ç†è§£æˆä¸€ä¸ªæä¾›è€…ï¼Œè€Œä¸”æ¯ä¸ªå¨å¸ˆå„æœ‰æ‰€é•¿ï¼Œæœ‰çš„æ“…é•¿ä¸­é¤ï¼Œæœ‰çš„æ“…é•¿è¥¿é¤ï¼Œæ¯ä¸ªå¨å¸ˆéƒ½æŠŠæ“…é•¿çš„ç”¨ <code>childContextTypes</code> è´´å‡ºæ¥ï¼Œä½ ä½œä¸ºæ¶ˆè´¹è€…ï¼Œç”¨ <code>contextTypes</code> æ˜ç¡®å‡ºæƒ³è¦åƒå“ªä¸ªå¨å¸ˆåšçš„é¤é¥®ï¼Œå€Ÿæ­¤åšåˆ°ç‰©å°½æ‰€éœ€ã€‚</p>
<h2>äºŒ æ–°ç‰ˆæœ¬ context åŸºæœ¬ä½¿ç”¨</h2>
<p>ä¸Šè¿°çš„ API ç”¨èµ·æ¥æµç¨‹å¯èƒ½ä¼šå¾ˆç¹çï¼Œè€Œä¸”è¿˜ä¾èµ–äº propsTypes ç­‰ç¬¬ä¸‰æ–¹åº“ã€‚æ‰€ä»¥ <code>v16.3.0</code> ä¹‹åï¼Œcontext api æ­£å¼å‘å¸ƒäº†ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ç”¨ createContext åˆ›å»ºå‡ºä¸€ä¸ª context ä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œcontext å¯¹è±¡æä¾›ä¸¤ä¸ªç»„ä»¶ï¼Œ<code>Provider</code>å’Œ <code>Consumer</code>ä½œä¸ºæ–°çš„æä¾›è€…å’Œæ¶ˆè´¹è€…ï¼Œè¿™ç§ context æ¨¡å¼ï¼Œæ›´ä¾¿æ·çš„ä¼ é€’ context ï¼Œè¿˜å¢åŠ äº†ä¸€äº›æ–°çš„ç‰¹æ€§ï¼Œä½†æ˜¯ä¹Ÿå¼•å‡ºäº†ä¸€äº›æ–°çš„é—®é¢˜ï¼Œä»€ä¹ˆé—®é¢˜åé¢ä¼šè®²åˆ°ã€‚æ¥ä¸‹æ¥éœ€è¦é‡ç‚¹ç ”ç©¶ä¸€ä¸‹æ–°ç‰ˆæœ¬çš„ context ã€‚</p>
<h3>1 createContext</h3>
<p><code>React.createContext</code> çš„åŸºæœ¬ç”¨æ³•å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> ThemeContext = React.createContext(<span class="hljs-literal">null</span>) <span class="hljs-comment">//</span>
<span class="hljs-keyword">const</span> ThemeProvider = ThemeContext.Provider  <span class="hljs-comment">//æä¾›è€…</span>
<span class="hljs-keyword">const</span> ThemeConsumer = ThemeContext.Consumer <span class="hljs-comment">// è®¢é˜…æ¶ˆè´¹è€…</span>
</code></pre>
<p>createContext æ¥å—ä¸€ä¸ªå‚æ•°ï¼Œä½œä¸ºåˆå§‹åŒ– context çš„å†…å®¹ï¼Œè¿”å›ä¸€ä¸ªcontext å¯¹è±¡ï¼ŒContext å¯¹è±¡ä¸Šçš„ Provider ä½œä¸ºæä¾›è€…ï¼ŒContext å¯¹è±¡ä¸Šçš„ Consumer ä½œä¸ºæ¶ˆè´¹è€…ã€‚</p>
<h3>2 æ–°ç‰ˆæœ¬æä¾›è€…</h3>
<p>é¦–å…ˆæ¥çœ‹ä¸€ä¸‹Providerçš„ç”¨æ³•ã€‚</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> ThemeProvider = ThemeContext.Provider  <span class="hljs-comment">//æä¾›è€…</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ProviderDemo</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">const</span> [ contextValue , setContextValue ] = React.useState({  <span class="hljs-attr">color</span>:<span class="hljs-string">'#ccc'</span>, <span class="hljs-attr">background</span>:<span class="hljs-string">'pink'</span> })
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">div</span>></span>
        <span class="hljs-tag">&#x3C;<span class="hljs-name">ThemeProvider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{</span> <span class="hljs-attr">contextValue</span> } ></span> 
            <span class="hljs-tag">&#x3C;<span class="hljs-name">Son</span> /></span>
        <span class="hljs-tag">&#x3C;/<span class="hljs-name">ThemeProvider</span>></span>
    <span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span></span>
}
</code></pre>
<p>provider ä½œç”¨æœ‰ä¸¤ä¸ªï¼š</p>
<ul>
<li>value å±æ€§ä¼ é€’ contextï¼Œä¾›ç»™ Consumer ä½¿ç”¨ã€‚</li>
<li>value å±æ€§æ”¹å˜ï¼ŒThemeProvider ä¼šè®©æ¶ˆè´¹ Provider value çš„ç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚</li>
</ul>
<h3>3 æ–°ç‰ˆæœ¬æ¶ˆè´¹è€…</h3>
<p>å¯¹äºæ–°ç‰ˆæœ¬æƒ³è¦è·å– context çš„æ¶ˆè´¹è€…ï¼ŒReact æä¾›äº†3ç§å½¢å¼ï¼Œæ¥ä¸‹æ¥ä¸€ä¸€ä»‹ç»è¿™ä¸‰ç§æ–¹å¼ã€‚</p>
<h4>â‘  ç±»ç»„ä»¶ä¹‹contextType æ–¹å¼</h4>
<p><code>React v16.6</code> æä¾›äº† contextType é™æ€å±æ€§ï¼Œç”¨æ¥è·å–ä¸Šé¢ Provider æä¾›çš„ value å±æ€§ï¼Œè¿™é‡Œæ³¨æ„çš„æ˜¯ contextType ï¼Œä¸æ˜¯ä¸Šè¿°è€ç‰ˆçš„contextTypes, å¯¹äº React èµ·çš„è¿™ä¸¤ä¸ªåå­—ï¼ŒçœŸæ˜¯å¤ªç›¸åƒäº†ã€‚</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> ThemeContext = React.createContext(<span class="hljs-literal">null</span>)
<span class="hljs-comment">// ç±»ç»„ä»¶ - contextType æ–¹å¼</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConsumerDemo</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span></span>{
   <span class="hljs-function"><span class="hljs-title">render</span>(<span class="hljs-params"></span>)</span>{
       <span class="hljs-keyword">const</span> { color,background } = <span class="hljs-built_in">this</span>.context
       <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">color</span>,<span class="hljs-attr">background</span> } } ></span>æ¶ˆè´¹è€…<span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span></span> 
   }
}
ConsumerDemo.contextType = ThemeContext

<span class="hljs-keyword">const</span> Son = <span class="hljs-function">()=></span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">ConsumerDemo</span> /></span></span>
</code></pre>
<ul>
<li>ç±»ç»„ä»¶çš„é™æ€å±æ€§ä¸Šçš„ contextType å±æ€§ï¼ŒæŒ‡å‘éœ€è¦è·å–çš„ contextï¼ˆ demo ä¸­çš„ ThemeContext ï¼‰ï¼Œå°±å¯ä»¥æ–¹ä¾¿è·å–åˆ°æœ€è¿‘ä¸€å±‚ Provider æä¾›çš„ contextValue å€¼ã€‚</li>
<li>è®°ä½è¿™ç§æ–¹å¼åªé€‚ç”¨äºç±»ç»„ä»¶ã€‚</li>
</ul>
<h4>â‘¡ å‡½æ•°ç»„ä»¶ä¹‹ useContext æ–¹å¼</h4>
<p>æ—¢ç„¶ç±»ç»„ä»¶éƒ½å¯ä»¥å¿«æ·è·å– context äº†ï¼Œé‚£ä¹ˆå‡½æ•°ç»„ä»¶ä¹Ÿåº”è¯¥ç ”ç©¶ä¸€ä¸‹å¦‚ä½•å¿«é€Ÿè·å– context å§ï¼Œäºæ˜¯ä¹ v16.8 React hooks æä¾›äº† <code>useContext</code>ï¼Œä¸‹é¢çœ‹ä¸€ä¸‹ useContext ä½¿ç”¨ã€‚</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> ThemeContext = React.createContext(<span class="hljs-literal">null</span>)
<span class="hljs-comment">// å‡½æ•°ç»„ä»¶ - useContextæ–¹å¼</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ConsumerDemo</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">const</span>  contextValue = React.useContext(ThemeContext) <span class="hljs-comment">/*  */</span>
    <span class="hljs-keyword">const</span> { color,background } = contextValue
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">color</span>,<span class="hljs-attr">background</span> } } ></span>æ¶ˆè´¹è€…<span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span></span> 
}
<span class="hljs-keyword">const</span> Son = <span class="hljs-function">()=></span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">ConsumerDemo</span> /></span></span>
</code></pre>
<p>useContext æ¥å—ä¸€ä¸ªå‚æ•°ï¼Œå°±æ˜¯æƒ³è¦è·å–çš„ context ï¼Œè¿”å›ä¸€ä¸ª value å€¼ï¼Œå°±æ˜¯æœ€è¿‘çš„ provider æä¾› contextValue å€¼ã€‚</p>
<h4>â‘¢ è®¢é˜…è€…ä¹‹ Consumer æ–¹å¼</h4>
<p>React è¿˜æä¾›äº†ä¸€ç§ Consumer è®¢é˜…æ¶ˆè´¹è€…æ–¹å¼ï¼Œæˆ‘ä»¬ç ”ç©¶ä¸€ä¸‹è¿™ç§æ–¹å¼å¦‚ä½•ä¼ é€’ context ã€‚</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> ThemeConsumer = ThemeContext.Consumer <span class="hljs-comment">// è®¢é˜…æ¶ˆè´¹è€…</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ConsumerDemo</span>(<span class="hljs-params">props</span>)</span>{
    <span class="hljs-keyword">const</span> { color,background } = props
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">color</span>,<span class="hljs-attr">background</span> } } ></span>æ¶ˆè´¹è€…<span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span></span> 
}
<span class="hljs-keyword">const</span> Son = <span class="hljs-function">() =></span> (
    <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">ThemeConsumer</span>></span>
       { /* å°† context å†…å®¹è½¬åŒ–æˆ props  */ }
       { (contextValue)=> <span class="hljs-tag">&#x3C;<span class="hljs-name">ConsumerDemo</span>  {<span class="hljs-attr">...contextValue</span>}  /></span> }
    <span class="hljs-tag">&#x3C;/<span class="hljs-name">ThemeConsumer</span>></span></span>
) 
</code></pre>
<ul>
<li>Consumer è®¢é˜…è€…é‡‡å– render props æ–¹å¼ï¼Œæ¥å—æœ€è¿‘ä¸€å±‚ provider ä¸­value å±æ€§ï¼Œä½œä¸º render props å‡½æ•°çš„å‚æ•°ï¼Œå¯ä»¥å°†å‚æ•°å–å‡ºæ¥ï¼Œä½œä¸º props æ··å…¥ <code>ConsumerDemo</code> ç»„ä»¶ï¼Œè¯´ç™½äº†å°±æ˜¯ context å˜æˆäº† propsã€‚</li>
</ul>
<h3>4 åŠ¨æ€context</h3>
<p>ä¸Šé¢è®²åˆ°çš„ context éƒ½æ˜¯é™æ€çš„ï¼Œä¸å˜çš„ï¼Œä½†æ˜¯å®é™…çš„åœºæ™¯ä¸‹ï¼Œcontext å¯èƒ½æ˜¯åŠ¨æ€çš„ï¼Œå¯å˜çš„ï¼Œæ¯”å¦‚è¯´å›åˆ°äº†æœ¬ç« èŠ‚æœ€å¼€å§‹çš„è¯é¢˜åˆ‡æ¢ä¸»é¢˜ï¼Œå› ä¸ºåˆ‡æ¢ä¸»é¢˜å°±æ˜¯åœ¨åŠ¨æ€æ”¹å˜ context çš„å†…å®¹ã€‚æ‰€ä»¥æ¥ä¸‹æ¥çœ‹ä¸€ä¸‹åŠ¨æ€æ”¹å˜ context ã€‚</p>
<pre><code class="hljs language-js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ConsumerDemo</span>(<span class="hljs-params"></span>)</span>{
     <span class="hljs-keyword">const</span> { color,background } = React.useContext(ThemeContext)
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">color</span>,<span class="hljs-attr">background</span> } } ></span>æ¶ˆè´¹è€…<span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span></span> 
}
<span class="hljs-keyword">const</span> Son = React.memo(<span class="hljs-function">()=></span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">ConsumerDemo</span> /></span></span>) <span class="hljs-comment">// å­ç»„ä»¶</span>

<span class="hljs-keyword">const</span> ThemeProvider = ThemeContext.Provider <span class="hljs-comment">//æä¾›è€…</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ProviderDemo</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">const</span> [ contextValue , setContextValue ] = React.useState({  <span class="hljs-attr">color</span>:<span class="hljs-string">'#ccc'</span>, <span class="hljs-attr">background</span>:<span class="hljs-string">'pink'</span> })
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">div</span>></span>
        <span class="hljs-tag">&#x3C;<span class="hljs-name">ThemeProvider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{</span> <span class="hljs-attr">contextValue</span> } ></span>
            <span class="hljs-tag">&#x3C;<span class="hljs-name">Son</span> /></span>
        <span class="hljs-tag">&#x3C;/<span class="hljs-name">ThemeProvider</span>></span>
        <span class="hljs-tag">&#x3C;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{</span> ()=></span> setContextValue({ color:'#fff' , background:'blue' })  } >åˆ‡æ¢ä¸»é¢˜<span class="hljs-tag">&#x3C;/<span class="hljs-name">button</span>></span>
    <span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span></span>
}
</code></pre>
<p>æ•ˆæœ</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/44823e8cb2e649afb33f3b121d11ada8~tplv-k3u1fbpfcp-watermark.image" alt="context5.gif"></p>
<p>Provider æ¨¡å¼ä¸‹ context æœ‰ä¸€ä¸ªæ˜¾è‘—çš„ç‰¹ç‚¹ï¼Œå°±æ˜¯ <strong>Provder çš„ value æ”¹å˜ï¼Œä¼šä½¿æ‰€æœ‰æ¶ˆè´¹ value çš„ç»„ä»¶é‡æ–°æ¸²æŸ“</strong>ï¼Œå¦‚ä¸Šé€šè¿‡ä¸€ä¸ª useState æ¥æ”¹å˜ contextValue çš„å€¼ï¼ŒcontextValue æ”¹å˜ï¼Œä¼šä½¿ ConsumerDemo è‡ªåŠ¨æ›´æ–°ï¼Œæ³¨æ„è¿™ä¸ªæ›´æ–°å¹¶ä¸æ˜¯ç”±çˆ¶ç»„ä»¶ son render é€ æˆçš„ï¼Œå› ä¸ºç»™ son ç”¨ memo å¤„ç†è¿‡ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼ŒSon æ²¡æœ‰è§¦å‘ renderï¼Œè€Œæ˜¯ ConsumerDemo è‡ªå‘çš„renderã€‚</p>
<p><strong>æ€»ç»“ï¼šåœ¨ Provider é‡Œ value çš„æ”¹å˜ï¼Œä¼šä½¿å¼•ç”¨<code>contextType</code>,<code>useContext</code> æ¶ˆè´¹è¯¥ context çš„ç»„ä»¶é‡æ–° render ï¼ŒåŒæ ·ä¼šä½¿ Consumer çš„ children å‡½æ•°é‡æ–°æ‰§è¡Œï¼Œä¸å‰ä¸¤ç§æ–¹å¼ä¸åŒçš„æ˜¯ Consumer æ–¹å¼ï¼Œå½“ context å†…å®¹æ”¹å˜çš„æ—¶å€™ï¼Œä¸ä¼šè®©å¼•ç”¨ Consumer çš„çˆ¶ç»„ä»¶é‡æ–°æ›´æ–°ã€‚</strong></p>
<p><strong>æš´éœ²é—®é¢˜</strong></p>
<p>ä½†æ˜¯ä¸Šè¿°çš„ demo æš´éœ²å‡ºä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯åœ¨ä¸Šè¿° son ç»„ä»¶æ˜¯ç”¨ memo å¤„ç†çš„ï¼Œå¦‚æœæ²¡æœ‰ memo å¤„ç†ï¼ŒuseState ä¼šè®© <code>ProviderDemo</code> é‡æ–° render ï¼Œæ­¤æ—¶ son æ²¡æœ‰å¤„ç†ï¼Œå°±ä¼šè·Ÿéšçˆ¶ç»„ä»¶ render ï¼Œé—®é¢˜æ˜¯å¦‚æœ son è¿˜æœ‰å¾ˆå¤šå­ç»„ä»¶ï¼Œé‚£ä¹ˆå…¨éƒ¨ render ä¸€éã€‚é‚£ä¹ˆ<strong>å¦‚ä½•é˜»æ­¢ Provider value æ”¹å˜é€ æˆçš„ children ï¼ˆ demo ä¸­çš„ Son ï¼‰ä¸å¿…è¦çš„æ¸²æŸ“ï¼Ÿ</strong></p>
<p>é’ˆå¯¹è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘åœ¨çŸ¥ä¹çœ‹è§è¿‡å¤§ä½¬ä»¬è§£ç­”ï¼Œè¯´çš„å¾ˆç„ä¹ï¼Œä¼šè®©ä¸æ˜¯æ·±å…¥æ¥è§¦ React çš„åŒå­¦å¾ˆç–‘æƒ‘ğŸ¤”ï¼Œç©¶å…¶æœ¬è´¨å°±æ˜¯å¦‚ä¸‹ä¸¤ä¸ªæ€è·¯ã€‚</p>
<ul>
<li>â‘  ç¬¬ä¸€ç§å°±æ˜¯åˆ©ç”¨ memoï¼ŒpureComponent å¯¹å­ç»„ä»¶ props è¿›è¡Œæµ…æ¯”è¾ƒå¤„ç†ã€‚</li>
</ul>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> Son = React.memo(<span class="hljs-function">()=></span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">ConsumerDemo</span> /></span></span>)  
</code></pre>
<ul>
<li>â‘¡ ç¬¬äºŒç§å°±æ˜¯ React æœ¬èº«å¯¹ React element å¯¹è±¡çš„ç¼“å­˜ã€‚React æ¯æ¬¡æ‰§è¡Œ render éƒ½ä¼šè°ƒç”¨ createElement å½¢æˆæ–°çš„ React element å¯¹è±¡ï¼Œå¦‚æœæŠŠ React element ç¼“å­˜ä¸‹æ¥ï¼Œä¸‹ä¸€æ¬¡è°ƒå’Œæ›´æ–°æ—¶å€™ï¼Œå°±ä¼šè·³è¿‡è¯¥ React element å¯¹åº” fiber çš„æ›´æ–°ã€‚</li>
</ul>
<pre><code class="hljs language-js">&#x3C;ThemeProvider value={ contextValue } >
    { React.useMemo(<span class="hljs-function">()=></span>  <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">Son</span> /></span></span> ,[]) }
&#x3C;/ThemeProvider>
</code></pre>
<h3>5 å…¶ä»–api</h3>
<h4>â‘  displayName</h4>
<p>context å¯¹è±¡æ¥å—ä¸€ä¸ªåä¸º <code>displayName</code> çš„ propertyï¼Œç±»å‹ä¸ºå­—ç¬¦ä¸²ã€‚React DevTools ä½¿ç”¨è¯¥å­—ç¬¦ä¸²æ¥ç¡®å®š context è¦æ˜¾ç¤ºçš„å†…å®¹ã€‚</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> MyContext = React.createContext(<span class="hljs-comment">/* åˆå§‹åŒ–å†…å®¹ */</span>);
MyContext.displayName = <span class="hljs-string">'MyDisplayName'</span>;

&#x3C;MyContext.Provider> <span class="hljs-comment">// "MyDisplayName.Provider" åœ¨ DevTools ä¸­</span>
&#x3C;MyContext.Consumer> <span class="hljs-comment">// "MyDisplayName.Consumer" åœ¨ DevTools ä¸­</span>
</code></pre>
<p><strong>ï½œ--------é—®ä¸ç­”---------ï½œ</strong><br>
<strong>é—®</strong>ï¼šcontext ä¸ props å’Œ react-redux çš„å¯¹æ¯”ï¼Ÿ</p>
<p><strong>ç­”</strong>ï¼š contextè§£å†³äº†ï¼š</p>
<ul>
<li>
<p>è§£å†³äº† props éœ€è¦æ¯ä¸€å±‚éƒ½æ‰‹åŠ¨æ·»åŠ  props çš„ç¼ºé™·ã€‚</p>
</li>
<li>
<p>è§£å†³äº†æ”¹å˜ value ï¼Œç»„ä»¶å…¨éƒ¨é‡æ–°æ¸²æŸ“çš„ç¼ºé™·ã€‚</p>
</li>
</ul>
<p>react-redux å°±æ˜¯é€šè¿‡ Provider æ¨¡å¼æŠŠ redux ä¸­çš„ store æ³¨å…¥åˆ°ç»„ä»¶ä¸­çš„ã€‚</p>
<p><strong>ï½œ--------end---------ï½œ</strong><br></p>
<h2>ä¸‰ contexté«˜é˜¶ç”¨æ³•</h2>
<h3>åµŒå¥— Provider</h3>
<p>å¤šä¸ª Provider ä¹‹é—´å¯ä»¥ç›¸äº’åµŒå¥—ï¼Œæ¥ä¿å­˜/åˆ‡æ¢ä¸€äº›å…¨å±€æ•°æ®ï¼š</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> ThemeContext = React.createContext(<span class="hljs-literal">null</span>) <span class="hljs-comment">// ä¸»é¢˜é¢œè‰²Context</span>
<span class="hljs-keyword">const</span> LanContext = React.createContext(<span class="hljs-literal">null</span>) <span class="hljs-comment">// ä¸»é¢˜è¯­è¨€Context</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ConsumerDemo</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">ThemeContext.Consumer</span>></span>
        { (themeContextValue)=> (
            <span class="hljs-tag">&#x3C;<span class="hljs-name">LanContext.Consumer</span>></span>
                { (lanContextValue) => {
                    const { color , background } = themeContextValue
                    return <span class="hljs-tag">&#x3C;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">color</span>,<span class="hljs-attr">background</span> } } ></span> { lanContextValue === 'CH'  ? 'å¤§å®¶å¥½ï¼Œè®©æˆ‘ä»¬ä¸€èµ·å­¦ä¹ React!' : 'Hello, let us learn React!'  }  <span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span> 
                } }
            <span class="hljs-tag">&#x3C;/<span class="hljs-name">LanContext.Consumer</span>></span>
        )  }
    <span class="hljs-tag">&#x3C;/<span class="hljs-name">ThemeContext.Consumer</span>></span></span>
}

<span class="hljs-keyword">const</span> Son = memo(<span class="hljs-function">()=></span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">ConsumerDemo</span> /></span></span>)
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ProviderDemo</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">const</span> [ themeContextValue ] = React.useState({  <span class="hljs-attr">color</span>:<span class="hljs-string">'#FFF'</span>, <span class="hljs-attr">background</span>:<span class="hljs-string">'blue'</span> })
    <span class="hljs-keyword">const</span> [ lanContextValue ] = React.useState(<span class="hljs-string">'CH'</span>) <span class="hljs-comment">// CH -> ä¸­æ–‡ ï¼Œ EN -> è‹±æ–‡</span>
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">ThemeContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{themeContextValue}</span>  ></span>
         <span class="hljs-tag">&#x3C;<span class="hljs-name">LanContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{lanContextValue}</span> ></span>
             <span class="hljs-tag">&#x3C;<span class="hljs-name">Son</span>  /></span>
         <span class="hljs-tag">&#x3C;/<span class="hljs-name">LanContext.Provider</span>></span>
    <span class="hljs-tag">&#x3C;/<span class="hljs-name">ThemeContext.Provider</span>></span></span>
}
</code></pre>
<p>æ•ˆæœï¼š</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ccff7c88313d4b4babc391cff29958cb~tplv-k3u1fbpfcp-watermark.image" alt="context3.jpg"></p>
<ul>
<li>ThemeContext ä¿å­˜ä¸»é¢˜ä¿¡æ¯ï¼Œç”¨ LanContext ä¿å­˜è¯­è¨€ä¿¡æ¯ã€‚</li>
<li>ä¸¤ä¸ª Provider åµŒå¥—æ¥ä¼ é€’å…¨å±€ä¿¡æ¯ã€‚</li>
<li>ç”¨ä¸¤ä¸ª Consumer åµŒå¥—æ¥æ¥å—ä¿¡æ¯ã€‚</li>
</ul>
<p>è¿˜æœ‰å°±æ˜¯å¯ä»¥å­¦ä¹ ä¸€äº›ä¼˜ç§€çš„å¼€æºåº“ï¼Œæ¯”å¦‚ ant-designï¼Œçœ‹çœ‹å®ƒæ˜¯å¦‚ä½•ä¼˜é›…çš„ä½¿ç”¨ context ã€‚</p>
<h3>é€å±‚ä¼ é€’Provider</h3>
<p>Provider è¿˜æœ‰ä¸€ä¸ªè‰¯å¥½çš„ç‰¹æ€§ï¼Œå°±æ˜¯å¯ä»¥é€å±‚ä¼ é€’ context ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ª context å¯ä»¥ç”¨å¤šä¸ª Provder ä¼ é€’ï¼Œä¸‹ä¸€å±‚çº§çš„ Provder ä¼šè¦†ç›–ä¸Šä¸€å±‚çº§çš„ Provder ã€‚React-redux ä¸­ connect å°±æ˜¯ç”¨è¿™ä¸ªè‰¯å¥½ç‰¹æ€§ä¼ é€’è®¢é˜…å™¨çš„ã€‚</p>
<pre><code class="hljs language-js"><span class="hljs-comment">// é€å±‚ä¼ é€’Provder</span>
<span class="hljs-keyword">const</span> ThemeContext = React.createContext(<span class="hljs-literal">null</span>)
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Son2</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">ThemeContext.Consumer</span>></span>
        { (themeContextValue2)=>{
            const { color , background } = themeContextValue2
            return  <span class="hljs-tag">&#x3C;<span class="hljs-name">div</span>  <span class="hljs-attr">className</span>=<span class="hljs-string">"sonbox"</span>  <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">color</span>,<span class="hljs-attr">background</span> } } ></span>  ç¬¬äºŒå±‚Provder <span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span>
        }  }
    <span class="hljs-tag">&#x3C;/<span class="hljs-name">ThemeContext.Consumer</span>></span></span>
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Son</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">const</span> { color, background } = React.useContext(ThemeContext)
    <span class="hljs-keyword">const</span> [ themeContextValue2 ] = React.useState({  <span class="hljs-attr">color</span>:<span class="hljs-string">'#fff'</span>, <span class="hljs-attr">background</span>:<span class="hljs-string">'blue'</span> }) 
    <span class="hljs-comment">/* ç¬¬äºŒå±‚ Provder ä¼ é€’å†…å®¹ */</span>
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">'box'</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">color</span>,<span class="hljs-attr">background</span> } } ></span>
        ç¬¬ä¸€å±‚Provder
        <span class="hljs-tag">&#x3C;<span class="hljs-name">ThemeContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{</span> <span class="hljs-attr">themeContextValue2</span> } ></span>
            <span class="hljs-tag">&#x3C;<span class="hljs-name">Son2</span>  /></span>
        <span class="hljs-tag">&#x3C;/<span class="hljs-name">ThemeContext.Provider</span>></span>
    <span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span></span>

}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Provider1Demo</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">const</span> [ themeContextValue ] = React.useState({  <span class="hljs-attr">color</span>:<span class="hljs-string">'orange'</span>, <span class="hljs-attr">background</span>:<span class="hljs-string">'pink'</span> })
     <span class="hljs-comment">/* ç¬¬ä¸€å±‚  Provider ä¼ é€’å†…å®¹  */</span>
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">ThemeContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{</span> <span class="hljs-attr">themeContextValue</span> } ></span>
        <span class="hljs-tag">&#x3C;<span class="hljs-name">Son</span>/></span>
    <span class="hljs-tag">&#x3C;/<span class="hljs-name">ThemeContext.Provider</span>></span></span> 
}
</code></pre>
<p>æ•ˆæœï¼š</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/34b61485cea445b48b5b40d0fa4ab25f~tplv-k3u1fbpfcp-watermark.image" alt="context4.jpg"></p>
<ul>
<li>å…¨å±€åªæœ‰ä¸€ä¸ª ThemeContext ï¼Œä¸¤æ¬¡ç”¨ provider ä¼ é€’ä¸¤ä¸ªä¸åŒ context ã€‚</li>
<li>ç»„ä»¶è·å– context æ—¶å€™ï¼Œä¼šè·å–ç¦»å½“å‰ç»„ä»¶æœ€è¿‘çš„ä¸Šä¸€å±‚ Provider ã€‚</li>
<li>ä¸‹ä¸€å±‚çš„ provider ä¼šè¦†ç›–ä¸Šä¸€å±‚çš„ provider ã€‚</li>
</ul>
<p>Provider ç‰¹æ€§æ€»ç»“ï¼š</p>
<ul>
<li>1 Provider ä½œä¸ºæä¾›è€…ä¼ é€’ context ï¼Œproviderä¸­valueå±æ€§æ”¹å˜ä¼šä½¿æ‰€æœ‰æ¶ˆè´¹contextçš„ç»„ä»¶é‡æ–°æ›´æ–°ã€‚</li>
<li>2 Providerå¯ä»¥é€å±‚ä¼ é€’contextï¼Œä¸‹ä¸€å±‚Providerä¼šè¦†ç›–ä¸Šä¸€å±‚Providerã€‚</li>
</ul>
<h2>å›› è¿›é˜¶å®è·µ-åˆ‡æ¢ä¸»é¢˜æ¨¡å¼</h2>
<p>æ¥ä¸‹æ¥å®è·µç”¨ Provider Api å®ç°ä¸€ä¸ªåˆ‡æ¢ ä¸»é¢˜é¢œè‰²çš„ demo ã€‚</p>
<p><strong>å®ç°æ•ˆæœ</strong></p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1cd88a1ed1fd4999ac5cf91e65bded9b~tplv-k3u1fbpfcp-watermark.image" alt="context6.gif"></p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> ThemeContext = React.createContext(<span class="hljs-literal">null</span>) <span class="hljs-comment">// ä¸»é¢˜é¢œè‰²Context</span>

<span class="hljs-keyword">const</span> theme = { <span class="hljs-comment">//ä¸»é¢˜é¢œè‰²</span>
    <span class="hljs-attr">dark</span>:{  <span class="hljs-attr">color</span>:<span class="hljs-string">'#1890ff'</span> , <span class="hljs-attr">background</span>:<span class="hljs-string">'#1890ff'</span>, <span class="hljs-attr">border</span>: <span class="hljs-string">'1px solid blue'</span> ,<span class="hljs-attr">type</span>:<span class="hljs-string">'dark'</span>,  },
    <span class="hljs-attr">light</span>: {  <span class="hljs-attr">color</span>:<span class="hljs-string">'#fc4838'</span> , <span class="hljs-attr">background</span>:<span class="hljs-string">'#fc4838'</span>, <span class="hljs-attr">border</span>: <span class="hljs-string">'1px solid pink'</span> ,<span class="hljs-attr">type</span>:<span class="hljs-string">'light'</span>  }
}

<span class="hljs-comment">/* inputè¾“å…¥æ¡† - useContext æ¨¡å¼ */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Input</span>(<span class="hljs-params">props</span>)</span>{
    <span class="hljs-keyword">const</span>  { color,border } = useContext(ThemeContext)
    <span class="hljs-keyword">const</span> { label , placeholder } = props
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">div</span>></span>
        <span class="hljs-tag">&#x3C;<span class="hljs-name">label</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">color</span> }} ></span>{ label }<span class="hljs-tag">&#x3C;/<span class="hljs-name">label</span>></span>
        <span class="hljs-tag">&#x3C;<span class="hljs-name">input</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"input"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">{placeholder}</span>  <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">border</span> }} /></span>
    <span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span></span>
}
<span class="hljs-comment">/* å®¹å™¨ç»„ä»¶ -  Consumeræ¨¡å¼ */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Box</span>(<span class="hljs-params">props</span>)</span>{
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">ThemeContext.Consumer</span>></span>
        { (themeContextValue)=>{
            const { border,color } = themeContextValue
            return <span class="hljs-tag">&#x3C;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"context_box"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">border</span>,<span class="hljs-attr">color</span> }} ></span>
            { props.children }
        <span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span>
        } }
    <span class="hljs-tag">&#x3C;/<span class="hljs-name">ThemeContext.Consumer</span>></span></span>
}

<span class="hljs-function"><span class="hljs-keyword">function</span>  <span class="hljs-title">Checkbox</span> (<span class="hljs-params">props</span>)</span>{
    <span class="hljs-keyword">const</span> { label ,name, onChange } = props
    <span class="hljs-keyword">const</span> { type , color } = React.useContext(ThemeContext)
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"checkbox"</span>  <span class="hljs-attr">onClick</span>=<span class="hljs-string">{onChange}</span> ></span>
        <span class="hljs-tag">&#x3C;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"name"</span> ></span> {label} <span class="hljs-tag">&#x3C;/<span class="hljs-name">label</span>></span>
       <span class="hljs-tag">&#x3C;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">{name}</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{type}</span> <span class="hljs-attr">name</span>=<span class="hljs-string">{name}</span> <span class="hljs-attr">checked</span>=<span class="hljs-string">{</span> <span class="hljs-attr">type</span> === <span class="hljs-string">name</span> }  <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">color</span> } } /></span>
    <span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span></span>
}

<span class="hljs-comment">// contextType æ¨¡å¼</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">PureComponent</span></span>{
    <span class="hljs-keyword">static</span> contextType = ThemeContext
    <span class="hljs-function"><span class="hljs-title">render</span>(<span class="hljs-params"></span>)</span>{
        <span class="hljs-keyword">const</span> { border , setTheme ,color  ,background} = <span class="hljs-built_in">this</span>.context
        <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"context_app"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">border</span> , <span class="hljs-attr">color</span> }}  ></span>
          <span class="hljs-tag">&#x3C;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"context_change_theme"</span>   ></span>
             <span class="hljs-tag">&#x3C;<span class="hljs-name">span</span>></span> é€‰æ‹©ä¸»é¢˜ï¼š <span class="hljs-tag">&#x3C;/<span class="hljs-name">span</span>></span>
             <span class="hljs-tag">&#x3C;<span class="hljs-name">Checkbox</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"light"</span>  <span class="hljs-attr">name</span>=<span class="hljs-string">"light"</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{</span> ()=></span> setTheme(theme.light) }  />
             <span class="hljs-tag">&#x3C;<span class="hljs-name">Checkbox</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"dark"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"dark"</span>  <span class="hljs-attr">onChange</span>=<span class="hljs-string">{</span> ()=></span> setTheme(theme.dark) }   />
          <span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span>
          <span class="hljs-tag">&#x3C;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">'box_content'</span> ></span>
            <span class="hljs-tag">&#x3C;<span class="hljs-name">Box</span> ></span>
                <span class="hljs-tag">&#x3C;<span class="hljs-name">Input</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"å§“åï¼š"</span>  <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¯·è¾“å…¥å§“å"</span>  /></span>
                <span class="hljs-tag">&#x3C;<span class="hljs-name">Input</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"ageï¼š"</span>  <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¯·è¾“å…¥å¹´é¾„"</span>  /></span>
                <span class="hljs-tag">&#x3C;<span class="hljs-name">button</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"searchbtn"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{</span> { <span class="hljs-attr">background</span> } } ></span>ç¡®å®š<span class="hljs-tag">&#x3C;/<span class="hljs-name">button</span>></span>
                <span class="hljs-tag">&#x3C;<span class="hljs-name">button</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"concellbtn"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{</span> { <span class="hljs-attr">color</span> } } ></span>å–æ¶ˆ<span class="hljs-tag">&#x3C;/<span class="hljs-name">button</span>></span>
            <span class="hljs-tag">&#x3C;/<span class="hljs-name">Box</span>></span>
            <span class="hljs-tag">&#x3C;<span class="hljs-name">Box</span> ></span>
                <span class="hljs-tag">&#x3C;<span class="hljs-name">HomeOutlined</span>  <span class="hljs-attr">twoToneColor</span>=<span class="hljs-string">{</span> <span class="hljs-attr">color</span> } /></span>
                <span class="hljs-tag">&#x3C;<span class="hljs-name">SettingFilled</span> <span class="hljs-attr">twoToneColor</span>=<span class="hljs-string">{</span> <span class="hljs-attr">color</span> }  /></span>
                <span class="hljs-tag">&#x3C;<span class="hljs-name">SmileOutlined</span> <span class="hljs-attr">twoToneColor</span>=<span class="hljs-string">{</span> <span class="hljs-attr">color</span> }  /></span>
                <span class="hljs-tag">&#x3C;<span class="hljs-name">SyncOutlined</span> <span class="hljs-attr">spin</span>  <span class="hljs-attr">twoToneColor</span>=<span class="hljs-string">{</span> <span class="hljs-attr">color</span> }  /></span>
                <span class="hljs-tag">&#x3C;<span class="hljs-name">SmileOutlined</span> <span class="hljs-attr">twoToneColor</span>=<span class="hljs-string">{</span> <span class="hljs-attr">color</span> }  <span class="hljs-attr">rotate</span>=<span class="hljs-string">{180}</span> /></span>
                <span class="hljs-tag">&#x3C;<span class="hljs-name">LoadingOutlined</span> <span class="hljs-attr">twoToneColor</span>=<span class="hljs-string">{</span> <span class="hljs-attr">color</span> }   /></span>
            <span class="hljs-tag">&#x3C;/<span class="hljs-name">Box</span>></span>
            <span class="hljs-tag">&#x3C;<span class="hljs-name">Box</span> ></span>
                <span class="hljs-tag">&#x3C;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"person_des"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">color:</span>'#<span class="hljs-attr">fff</span>' , <span class="hljs-attr">background</span> }}  ></span>
                    I am alien  <span class="hljs-tag">&#x3C;<span class="hljs-name">br</span>/></span>
                    let us learn React!
                <span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span>
            <span class="hljs-tag">&#x3C;/<span class="hljs-name">Box</span>></span>
          <span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span>
     <span class="hljs-tag">&#x3C;/<span class="hljs-name">div</span>></span></span>
    }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">const</span> [ themeContextValue ,setThemeContext ] = React.useState(theme.dark) 
    <span class="hljs-comment">/* ä¼ é€’é¢œè‰²ä¸»é¢˜ å’Œ æ”¹å˜ä¸»é¢˜çš„æ–¹æ³• */</span>
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">ThemeContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{</span> { <span class="hljs-attr">...themeContextValue</span>, <span class="hljs-attr">setTheme:setThemeContext</span>  } } ></span>
        <span class="hljs-tag">&#x3C;<span class="hljs-name">App</span>/></span>
    <span class="hljs-tag">&#x3C;/<span class="hljs-name">ThemeContext.Provider</span>></span></span>
}
</code></pre>
<p>æµç¨‹åˆ†æï¼š</p>
<ul>
<li>åœ¨ Root ç»„ä»¶ä¸­ï¼Œç”¨ Provider æŠŠä¸»é¢˜é¢œè‰² <code>themeContextValue</code> å’Œæ”¹å˜ä¸»é¢˜çš„ <code>setTheme</code> ä¼ å…¥ context ã€‚</li>
<li>åœ¨ App ä¸­åˆ‡æ¢ä¸»é¢˜ã€‚</li>
<li>å°è£…ç»Ÿä¸€çš„ Input Checkbox Box ç»„ä»¶ï¼Œç»„ä»¶å†…éƒ¨æ¶ˆè´¹ä¸»é¢˜é¢œè‰²çš„ context ï¼Œä¸»é¢˜æ”¹å˜ï¼Œç»Ÿä¸€æ›´æ–°ï¼Œè¿™æ ·å°±ä¸å¿…åœ¨æ¯ä¸€ä¸ªæ¨¡å—éƒ½ç»‘å®šä¸»é¢˜ï¼Œç»Ÿä¸€ä½¿ç”¨ä¸»ä½“ç»„ä»¶å°±å¯ä»¥äº†ã€‚</li>
</ul>
<h2>äº” æ€»ç»“</h2>
<p>é€šè¿‡è¿™èŠ‚å­¦ä¹ äº†ï¼š</p>
<ul>
<li>è€ç‰ˆæœ¬çš„ context å’Œ æ–°ç‰ˆæœ¬çš„ context ã€‚</li>
<li>æ–°ç‰ˆæœ¬æä¾›è€… Provider ç‰¹æ€§å’Œä¸‰ç§æ¶ˆè´¹è€…æ¨¡å¼ã€‚</li>
<li>context çš„é«˜é˜¶ç”¨æ³•ã€‚</li>
<li>å®è·µ demo åˆ‡æ¢ä¸»é¢˜ã€‚</li>
</ul>
<p>ä¸‹ä¸€èŠ‚ï¼Œå°†ä¸€èµ·ç ”ç©¶css in React!</p></div>
</body></html>
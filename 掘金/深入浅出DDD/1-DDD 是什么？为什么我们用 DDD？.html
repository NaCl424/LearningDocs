<!DOCTYPE html><html lang="en"><head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>第 01 讲：设计一份吸引面试官的简历</title>
<style type="text/css">
:root {
    --control-text-color: #777;
    --select-text-bg-color: rgba(223, 197, 223);  /*#7e66992e;*/
    
    /* side bar */
    --side-bar-bg-color: rgb(255, 255, 255);
    --active-file-text-color: #8163bd;
    --active-file-bg-color: #E9E4F0;
    --item-hover-bg-color: #E9E4F0;
    --active-file-border-color: #8163bd;

    --title-color: #6c549c;
    --font-sans-serif: 'Ubuntu', 'Source Sans Pro', sans-serif !important;
    --font-monospace: 'Fira Code', 'Roboto Mono', monospace !important;
    --purple-1: #8163bd;
    --purple-2: #79589F;
    --purple-3: #fd5eb8;
    --purple-light-1: rgba(99, 99, 172, .05);
    --purple-light-2: rgba(99, 99, 172, .1);
    --purple-light-3: rgba(99, 99, 172, .2);
    --purple-light-4: rgba(129, 99, 189, .3);
    --purple-light-5: #E9E4F0;
    --purple-light-6: rgba(129, 99, 189, .8);
}

/* html {
    font-size: 16px;
} */

body {
    font-family: var(--font-sans-serif);
    color: #34495e;
    -webkit-font-smoothing: antialiased;
    line-height: 1.6rem;
    letter-spacing: 0;
    margin: 0;
    overflow-x: hidden;
}

/* 页边距 和 页面大小 */
#write {
    padding-left: 6ch;
    padding-right: 6ch;
    margin: 0 auto;
}

#write p {
    line-height: 1.6rem;
    word-spacing: .05rem;
}

#write ol li {
    padding-left: 0.5rem;
}

#write > ul:first-child,
#write > ol:first-child {
    margin-top: 30px;
}

body > *:first-child {
    margin-top: 0 !important;
}

body > *:last-child {
    margin-bottom: 0 !important;
}

a {
    color: var(--purple-1);
    padding: 0 2px;
    text-decoration: none;
}
.md-content {
    color: var(--purple-light-6);
}
#write a {
    border-bottom: 1px solid var(--purple-1);
    color: var(--purple-1);
    text-decoration: none;
}

h1,
h2,
h3,
h4,
h5,
h6 {
    position: relative;
    margin-top: 1rem;
    margin-bottom: 0.5rem;
    /* font-weight: bold; */
    font-weight: 500 !important;
    line-height: 1.4;
    cursor: text;
    color: var(--title-color);
    font-family: var(--font-sans-serif);
}

h1:hover a.anchor,
h2:hover a.anchor,
h3:hover a.anchor,
h4:hover a.anchor,
h5:hover a.anchor,
h6:hover a.anchor {
    text-decoration: none;
}

h1 tt,
h1 code {
    font-size: inherit !important;
}
h2 tt,
h2 code {
    font-size: inherit !important;
}
h3 tt,
h3 code {
    font-size: inherit !important;
}
h4 tt,
h4 code {
    font-size: inherit !important;
}
h5 tt,
h5 code {
    font-size: inherit !important;
}
h6 tt,
h6 code {
    font-size: inherit !important;
}


h1 {
    padding-bottom: .4rem;
    font-size: 2.2rem;
    line-height: 1.3;
}
h1 {
    text-align: center;
    padding-bottom: 0.3em;
    font-size: 2.2em;
    line-height: 1.2;
    margin: 2.4em auto 1.2em;
}
h1:after {
    content: '';
    display: block;
    margin: 0.2em auto 0;
    width: 100px;
    height: 2px;
    border-bottom: 2px solid var(--title-color);
}

h2 {
    margin: 1.6em auto 0.5em;
    padding-left: 10px;
    line-height: 1.4;
    font-size: 1.8em;
    border-left: 9px solid var(--title-color);
    border-bottom: 1px solid var(--title-color);
}
h3 {
    font-size: 1.5rem;
    margin: 1.2em auto 0.5em;
}
h4 {
    font-size: 1.3rem;
}
h5 {
    font-size: 1.2rem;
}
h6 {
    font-size: 1.1rem;
}

p,
blockquote,
ul,
ol,
dl,
table {
    margin: 0.8em 0;
}

li > ol,
li > ul {
    margin: 0 0;
}

hr {
    height: 2px;
    padding: 0;
    margin: 16px 0;
    background-color: #e7e7e7;
    border: 0 none;
    overflow: hidden;
    box-sizing: content-box;
}

body > h2:first-child {
    margin-top: 0;
    padding-top: 0;
}

body > h1:first-child {
    margin-top: 0;
    padding-top: 0;
}

body > h1:first-child + h2 {
    margin-top: 0;
    padding-top: 0;
}

body > h3:first-child,
body > h4:first-child,
body > h5:first-child,
body > h6:first-child {
    margin-top: 0;
    padding-top: 0;
}

a:first-child h1,
a:first-child h2,
a:first-child h3,
a:first-child h4,
a:first-child h5,
a:first-child h6 {
    margin-top: 0;
    padding-top: 0;
}

h1 p,
h2 p,
h3 p,
h4 p,
h5 p,
h6 p {
    margin-top: 0;
}

li p.first {
    display: inline-block;
}

ul,
ol {
    padding-left: 30px;
}

ul:first-child,
ol:first-child {
    margin-top: 0;
}

ul:last-child,
ol:last-child {
    margin-bottom: 0;
}

/* 引用 */
blockquote {
    /* margin-left: 1rem; */
    border-left: 4px solid var(--purple-light-4);
    padding: 10px 15px;
    color: #777;
    background-color: var(--purple-light-1);
}

/* 表格 */
table {
    padding: 0;
    word-break: initial;
}

table tr {
    border-top: 1px solid #dfe2e5;
    margin: 0;
    padding: 0;
}

/* 表格 背景色 */
table tr:nth-child(2n),
thead {
    background-color: var(--purple-light-1);
}
#write table thead th {
    background-color: var(--purple-light-2);
}

table tr th {
    font-weight: bold;
    border: 1px solid #dfe2e5;
    border-bottom: 0;
    text-align: left;
    margin: 0;
    padding: 6px 13px;
}

table tr td {
    border: 1px solid #dfe2e5;
    text-align: left;
    margin: 0;
    padding: 6px 13px;
}

table tr th:first-child,
table tr td:first-child {
    margin-top: 0;
}

table tr th:last-child,
table tr td:last-child {
    margin-bottom: 0;
}

/* 粗体 */
#write strong {
    padding: 0 2px;
    color: var(--purple-1);
}

/* 斜体 */
#write em {
    padding: 0 5px 0 2px;
    /* font-style: normal; */
    color: #42b983;
}

/* inline code */
#write code, tt {
    padding: 2px 4px;
    border-radius: 2px;
    font-family: var(--font-monospace);
    font-size: 0.92rem;
    color: var(--purple-3); 
    background-color: rgba(99, 99, 172, .05);
}

tt {
    margin: 0 2px;
}

#write .md-footnote {
    background-color: #f8f8f8;
    color: var(--purple-3);
}

/* heighlight. */
#write mark {
    background-color: #fbd3ea;
    border-radius: 2px;
    padding: 2px 4px;
    margin: 0 2px;
}

#write del {
    padding: 1px 2px;
}

.md-task-list-item > input {
    margin-left: -1.3em;
}

@media print {
    html {
        font-size: 0.9rem;
    }

    table,
    pre {
        page-break-inside: avoid;
    }

    pre {
        word-wrap: break-word;
    }
}

#write pre.md-meta-block {
    padding: 1rem;
    font-size: 85%;
    line-height: 1.45;
    background-color: #f7f7f7;
    border: 0;
    border-radius: 3px;
    color: #777777;
    margin-top: 0 !important;
}

.mathjax-block > .code-tooltip {
    bottom: .375rem;
}

/* 图片 */
.md-image > .md-meta {
    border-radius: 3px;
    font-family: var(--font-monospace);
    padding: 2px 0 0 4px;
    font-size: 0.9em;
    color: inherit;
}
p .md-image:only-child{
    width: auto;
    text-align: left;
    margin-left: 2rem;
}
.md-tag {
    color: inherit;
}
/* 当 “![shadow-随便写]()”写时，会有阴影 */
.md-image img[alt|='shadow'] {
    /* box-shadow: 0 4px 24px -6px #ddd; */
    box-shadow:var(--purple-light-2) 0px 10px 15px;
}

#write a.md-toc-inner {
    line-height: 1.6;
    white-space: pre-line;
    border-bottom: none;
    font-size: 0.9rem;
}

#typora-quick-open {
    border: 1px solid #ddd;
    background-color: #f8f8f8;
}

#typora-quick-open-item {
    background-color: #FAFAFA;
    border-color: #FEFEFE #e5e5e5 #e5e5e5 #eee;
    border-style: solid;
    border-width: 1px;
}

#md-notification:before {
    top: 10px;
}

header,
.context-menu,
.megamenu-content,
footer {
    font-family: var(--font-sans-serif);
}

.file-node-content:hover .file-node-icon,
.file-node-content:hover .file-node-open-state {
    visibility: visible;
}

.md-lang {
    color: #b4654d;
}

.html-for-mac .context-menu {
    --item-hover-bg-color: #E6F0FE;
}

/* 代码框 */
/* CodeMirror 3024 Day theme */

/* 代码段 背景 */
pre {
    --select-text-bg-color: rgba(223, 197, 223) !important;
    margin: .5em 0;
    padding: 1em 1.4em;
    border-radius: 8px;
    background: #f6f8fa;
    overflow-x: auto;
    box-sizing: border-box;
    font-size: 14px;
}

/* 边框 */
.md-fences {
    border: 1px solid #e7eaed;
    border-radius: 3px;
}

.cm-s-inner {
  padding: .25rem;
  border-radius: .25rem;
}

.cm-s-inner.CodeMirror, .cm-s-inner .CodeMirror-gutters {
  background-color: #f8f8f8 !important;
  color: #3a3432 !important;
  border: none;
}

.cm-s-inner .CodeMirror-gutters {
  color: #6d8a88;
}

.cm-s-inner .CodeMirror-cursor {
  border-left: solid thin #5c5855 !important;
}

.cm-s-inner .CodeMirror-linenumber {
  color: #807d7c;
}

.cm-s-inner .CodeMirror-line::selection, .cm-s-inner .CodeMirror-line::-moz-selection,
.cm-s-inner .CodeMirror-line > span::selection,
.cm-s-inner .CodeMirror-line > span::-moz-selection,
.cm-s-inner .CodeMirror-line > span > span::selection,
.cm-s-inner .CodeMirror-line > span > span::-moz-selection {
  background: var(--purple-light-2);
}

.cm-s-inner span.cm-comment {
  color: #cdab53;
}

.cm-s-inner span.cm-string, .cm-s-inner span.cm-string-2 {
  color: #f2b01d;
}

.cm-s-inner span.cm-number {
  color: #a34e8f;
}

.cm-s-inner span.cm-variable {
  color: #01a252;
}

.cm-s-inner span.cm-variable-2 {
  color: #01a0e4;
}

.cm-s-inner span.cm-def {
  /* color: #e8bbd0; */
  color: #e2287f;
}

.cm-s-inner span.cm-operator {
  color: #ff79c6;
}

.cm-s-inner span.cm-keyword {
  color: #db2d20;
}

.cm-s-inner span.cm-atom {
  color: #a34e8f;
}

.cm-s-inner span.cm-meta {
  color: inherit;
}

.cm-s-inner span.cm-tag {
  color: #db2d20;
}

.cm-s-inner span.cm-attribute {
  color: #01a252;
}

.cm-s-inner span.cm-qualifier {
  color: #388aa3;
}

.cm-s-inner span.cm-property {
  color: #01a252;
}

.cm-s-inner span.cm-builtin {
  color: #388aa3;
}

.cm-s-inner span.cm-variable-3, .cm-s-inner span.cm-type {
  color: #ffb86c;
}

.cm-s-inner span.cm-bracket {
  color: #3a3432;
}

.cm-s-inner span.cm-link {
  color: #a34e8f;
}

.cm-s-inner span.cm-error {
  background: #db2d20;
  color: #5c5855;
}

/* .md-fences.md-focus .cm-s-inner .CodeMirror-activeline-background {
  background: var(--purple-light-2);
} */

.cm-s-inner .CodeMirror-matchingbracket {
  text-decoration: underline;
  color: #a34e8f !important;
}

#fences-auto-suggest .active {
  background: #ddd;
}

#write .code-tooltip {
  bottom: initial;
  top: calc(100% - 1px);
  background: #f7f7f7;
  border: 1px solid #ddd;
  border-top: 0;
}

.auto-suggest-container {
  border-color: #b4b4b4;
}

.auto-suggest-container .autoComplt-hint.active {
  background: #b4b4b4;
  color: inherit;
}

/* task list */
#write .md-task-list-item > input {
  -webkit-appearance: initial;
  display: block;
  position: absolute;
  border: 1px solid #b4b4b4;
  border-radius: .25rem;
  margin-top: .1rem;
  margin-left: -1.8rem;
  height: 1.2rem;
  width: 1.2rem;
  transition: background 0.3s;
}

#write .md-task-list-item > input:focus {
  outline: none;
  box-shadow: none;
}

#write .md-task-list-item > input:hover {
  background: #ddd;
}

#write .md-task-list-item > input[checked]::before {
  content: '';
  position: absolute;
  top: 20%;
  left: 50%;
  height: 60%;
  width: 2px;
  transform: rotate(40deg);
  background: #333;
}

#write .md-task-list-item > input[checked]::after {
  content: '';
  position: absolute;
  top: 46%;
  left: 25%;
  height: 30%;
  width: 2px;
  transform: rotate(-40deg);
  background: #333;
}

#write .md-task-list-item > p {
  transition: color 0.3s, opacity 0.3s;
}

#write .md-task-list-item.task-list-done > p {
  color: #b4b4b4;
  text-decoration: line-through;
}

#write .md-task-list-item.task-list-done > p > .md-emoji {
  opacity: .5;
}

#write .md-task-list-item.task-list-done > p > .md-link > a {
  opacity: .6;
}

/* sidebar and outline */
.pin-outline .outline-active {
  color: var(--active-file-text-color); 
}

.file-list-item {
    border-bottom: 1px solid;
    border-color: var(--purple-light-5);
}

.file-list-item-summary {
    font-weight: 400;
}

.file-list-item.active {
    color: var(--active-file-text-color);
    background-color: var(--purple-light-5);
}

.file-tree-node.active>.file-node-background {
    background-color: var(--purple-light-5);
    font-weight: 700;
} 

.file-tree-node.active>.file-node-content {
    color: var(--active-file-text-color);
    font-weight: 700;
}

.file-node-content {
    color: #5e676d;
}

.sidebar-tabs {
    border-bottom: none;
}
.sidebar-tab.active {
    font-weight: 400;
}

.sidebar-content-content {
    font-size: 0.9rem;
}

img {
    max-width: 100%;
}

body {
    background-color: rgb(237, 237, 237);
}
#content {
    width: 836px;
    padding: 50px;
    background: #fff;
    margin: 0 auto;
}/*# sourceURL=/Users/young/Documents/Codes/Fun/lagou/public/purple.css*/</style><style type="text/css">.hljs{display:block;overflow-x:auto;padding:.5em;color:#383a42;background:#fafafa}.hljs-comment,.hljs-quote{color:#a0a1a7;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e45649}.hljs-literal{color:#0184bb}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#50a14f}.hljs-built_in,.hljs-class .hljs-title{color:#c18401}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#4078f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}/*# sourceURL=/Users/young/Documents/Codes/Fun/lagou/public/atom-one-light.min.css*/</style></head>
<body>
<div id="content"><h1>DDD 是什么？为什么我们用 DDD？</h1>
<p>我相信基本上 99% 的 Java 开发读者，不管你是计科专业还是跨专业出身，初学 Spring 或 SpringBoot 进行 Web 开发的时候，接触到的代码分层都是 MVC 架构。</p>
<p>MVC，全称 Model View Control（模型-视图-控制器），其分层定义如下。</p>
<ul>
<li>
<p><strong>M（模型层/ DAO 层）</strong> ：业务数据载体层。</p>
</li>
<li>
<p><strong>V（视图层/ Controller 层）</strong> ：展现给用户的数据表示层。</p>
</li>
<li>
<p><strong>C（控制层/ Service 层）</strong> ：接受 V（视图层）传递过来的请求进行业务逻辑处理，并将处理后的 M 层（模型层）数据返回给 V（视图层）。</p>
</li>
</ul>
<p>因为 MVC 对于刚刚接触 Web 开发的同学来说有它自身独有的优势：</p>
<ul>
<li>分层简单易懂；</li>
<li>层级逻辑替换方便；</li>
<li>可以降低层与层之间的依赖；</li>
<li>有利于标准化；</li>
<li>利于层与层逻辑的复用。</li>
</ul>
<p>但真实情况是这样吗？<strong>随着系统功能迭代，业务功能越来越丰富之后，控制层里面对于业务逻辑处理的代码也越来越多，维护成本也越来越高</strong>。</p>
<p>举个例子：你负责了一个 MVC 项目从 0 到 1 的搭建，后面业务越来越好，招了新的研发一起迭代需求。在版本迭代的过程中，Service 层逻辑方法类似又不完全相同。A 同学拷贝了你的代码，改了一小段逻辑，开了一个新的方法。B 同学看到两个类似的逻辑，偷偷在里面加了一个 if/else 的判断。C 同学再按照自己的理解去写了一个已经存在的逻辑……</p>
<p>那么，随着时间的推移，你会遇到什么样的工程问题呢？</p>
<ul>
<li>工程体积庞大；</li>
<li>需求迭代会出现明明是类似的功能，却无法复用代码逻辑的情况；</li>
<li>重复的代码很多；</li>
<li>大类（几千上万行）随处可见；</li>
<li>出了 Bug 不敢直接修复，只能继续往上贴逻辑；</li>
<li>代码可读性很差，不加注释你都难以理解业务逻辑；</li>
<li>功能之间耦合严重，改了一个 Bug，莫名其妙又出现了好几个其他的 Bug；</li>
<li>外部系统 RPC 接口修改，大范围影响到本系统的逻辑；</li>
<li>……</li>
</ul>
<p>归根到底的原因是什么？</p>
<p>控制层就像个万能容器，什么代码都往里面写，承载了它这个年纪不该承受的业务逻辑。反观模型层与视图层，空空如也。业务逻辑不是跟着业务模型走的，而是在现有数据模型的情况下，或者先设计数据模型的情况下去迭代了业务需求。业务模块之间的边界被淡化，控制层内逻辑只要能实现需求，想怎么写就怎么写，没有一个规范与规约。</p>
<p>为了解决常规中大型 Web 系统 MVC 架构下存在的弊端问题，这就引出了 DDD。这也是本小册的大主题。在本小册中，我会带你看 DDD 如何从业务模型与业务边界出发去设计代码层级结构，将散落的、重复的逻辑内聚到业务模型中。从基础概念出发到落地实战演示，带你进入 DDD 的世界。</p>
<p>今天这一讲的内容相较而言偏原理些，都是讲解 DDD 相关的基础信息。虽然基础，但很关键，毕竟只有夯实好基础，而后才能更好地实战。</p>
<h2>一、DDD 是什么</h2>
<p>如果你在阅读小册前了解过 DDD ，应该听过网上那种官方的介绍：</p>
<ul>
<li>Domain Driven Design（领域驱动设计）；</li>
<li>六边形架构模型；</li>
<li>任何项目相关的人员都能理解的通用语言；</li>
<li>……</li>
</ul>
<p>说的都多多少少抽象点了，“听君一席话，如听一席话”。下面我们化抽象为具体，结合示意图和业务示例来看看 DDD 到底是什么。</p>
<p>在使用 MVC 架构进行开发时，用户需求从被提出到落地，会经历下图的生命周期：</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1eeaf1af49fc4bf5974fa27f6fd7abb9~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p>
<p>可以看到，用户需求会被生命周期每层参与人理解转化。用户提出的 A 需求到了产品那里可能被理解成了 A1；需求评审结束后，进行编码开发需求之前，往往最先做的一步就是设计表结构，此时需求可能被理解成了 A2；等表结构设计完成，再“自底向上”设计 DAO、Service、Controller，最终产出了 A3。</p>
<p><strong>众所周知，“人”才是系统最大的 Bug。</strong></p>
<p>特别是研发需求在数据库结构这一层转化后，将业务以主观臆断行为进行了转化。一旦业务边界划分模糊，考虑不全，大量的逻辑补充堆积到了代码层实现，变得越来越难维护，到处是 if/else，“祖传代码”就此诞生了。</p>
<p>为了解决上述问题，DDD 所要做的就是（也可以结合下图来理解）：</p>
<ul>
<li>通过<strong>事件风暴</strong>消除信息不对称，让业务相关人员都参与设计，确定每个业务领域的职责边界；</li>
</ul>

<ul>
<li>将常规 MVC 三层架构中自底 <strong>（数据模型）</strong> 向上的设计方式做一个<strong>反转</strong>，以业务为主导，自顶 <strong>（业务模型）</strong> 向下地进行业务领域划分；</li>
</ul>

<ul>
<li>将大的业务需求进行拆分，建立<strong>业务领域模型</strong>，分而治之。</li>
</ul>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/691975d95c174de29eefbaea6d961a6f~tplv-k3u1fbpfcp-zoom-1.image" alt=""></p>
<p>说到这里，对于 DDD 与 MVC 的区别，你可能还是有点模糊。这里我们就以<code>电商订单场景为例</code>分析下。假如我们现在要做一个电商下单的需求，这会涉及到用户选定商品、下订单、支付订单、订单发货等步骤。</p>
<ul>
<li><strong>MVC 架构。</strong> 常见的做法是在分析好业务需求之后，就开始设计表结构了，订单表、支付表、商品表等。然后编写业务逻辑，但这仅仅是第一个版本的需求。不久后功能迭代了，订单支付后可以取消，下单的商品可以退换货，那是不是又需要进行加表？紧跟着对应的实现逻辑也需要修改？功能不断迭代，代码就不断地层层往上叠。</li>
</ul>

<ul>
<li><strong>DDD 架构。</strong> 首先进行业务边界划分，这里面核心是订单，那么<strong>订单就是这个业务领域里面的聚合逻辑体现</strong>。支付、商品信息、地址等都是围绕着订单展开。订单本身的属性确定之后，地址等信息只是一个属性的体现。当你将订单的领域模型构建好之后，后续的逻辑边界与表结构设计也就随之而来了，功能点无非就是对订单聚合内的业务逻辑编排组合罢了，让业务逻辑的实现最原子化。</li>
</ul>
<h2>二、DDD 如何解决 MVC 痛点</h2>
<p><strong>业务的交互方式要分为两种：系统内部交互，系统与外部交互。</strong></p>
<p>MVC 分层下，不论是系统内交互还是系统与外部交互，逻辑都是按照功能点被杂糅在一起。Service 层利用 DO、DTO、VO 等业务 POJO 作为数据载体，完成了所有模型之间的逻辑处理、数据转换等跟业务有关或者无关的事情。Service 层臃肿且条理不清晰。就像是吃大乱炖，什么都往里面加，反正最后能吃就行。而这些 POJO 除了字段属性，内部没有任何的业务逻辑，这就是典型的<strong>贫血模型</strong>。</p>
<p>DDD 核心思想是什么呢？<strong>解耦与内聚</strong>！建立领域模型形成聚合根，将原先散落在 Service 层的业务逻辑收拢到领域模型内部，变成<strong>充血模型</strong>，聚合即为业务。业务不是像炒大锅饭一样混在一起，而是一道道工序复杂的美食，都有它们自己独立的做法。</p>
<p>下面来看看 DDD 是如何处理这两种交互方式的。</p>
<h3>1. 系统内部交互</h3>
<p>DDD 的价值观里面，<strong>任何业务都是某个业务领域模型的职责体现</strong>。为了完成某一个需求功能，将核心的业务逻辑定义在领域内部，应用服务层编排调用领域中的业务方法来实现功能点的需求。也就是说，业务功能是领域所供的能力的组合。</p>
<p>这样，<strong>每个领域只会做自己业务边界内的事情，最小细粒度地去定义需求的实现</strong>。原先模型层空空的贫血模型摇身一变，变成了充血模型。进到应用服务层，你的代码就是你的业务逻辑。逻辑清晰，可维护性高！</p>
<h3>2. 系统与外部交互</h3>
<p>假如微服务体系下，有一个下订单的需求。在通过<strong>订单服务</strong>下订单前，需要先请求<strong>用户服务</strong>获取下单用户的个人信息，如下图，用户服务在版本 A 时获取用户详情的接口是 interfaceA，版本 B 时换成 interfaceB。那么就会出现，需要修改订单服务中获取用户信息的逻辑。如果类似的逻辑散落在系统的很多地方，就会出现外部系统的业务逻辑变更，造成了本系统的大量依赖变更。</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f6514ecacb0145feb7caddc6898909c6~tplv-k3u1fbpfcp-zoom-1.image" alt=""></p>
<p>从上面的例子可知，系统内部完成业务逻辑可能会与外部系统进行交互，而此时外部系统一旦发生逻辑变更，将会影响到任意一个系统内依赖外部系统的逻辑。</p>
<p>为了解决这个痛点问题，DDD 通过定义<strong>适配器</strong>包装对外部系统的依赖。系统内部直接依赖适配器，由适配器去调用外部接口，减小外部系统的变动对本系统业务逻辑的影响。</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/debbf26854ba4510b6780e2dcd7e4d0f~tplv-k3u1fbpfcp-zoom-1.image" alt=""></p>
<h2>三、DDD 的优势是什么</h2>
<p>通过上面的介绍和剖析，不难总结出 DDD 主要有以下优势。</p>
<ul>
<li>
<p>从业务出发，自顶向下设计系统，优先考虑领域模型，而不是切割数据和行为，告别贫血模型；</p>
</li>
<li>
<p>领域设计简化复杂业务，内聚逻辑实现，准确传达业务规则，分而治之；</p>
</li>
<li>
<p>应用服务层的编排即展示了业务逻辑，增强了代码的可读性与可维护性；</p>
</li>
<li>
<p>消除业务参与人员的信息不对称，提升协助效率；</p>
</li>
<li>
<p>将外部系统等不可控因素转化为可控因素，减小系统间依赖；</p>
</li>
<li>
<p>适合于业务复杂的中台化的系统设计。</p>
</li>
</ul>
<h2>四、到底什么样的系统适配 DDD</h2>
<p>看完上文对于 DDD 的分析之后，你是不是觉得一对比，MVC 简直就是“弟弟”？但是你回过头来想想，DDD 其实在十几年前就已经被提出来了，但为什么是近几年才开始逐渐进入大众的视野呢？总结起来，主要有以下几条原因。</p>
<ul>
<li>DDD 的结构不像 MVC 结构那么简单，分层更加复杂。</li>
<li>消除信息不对称的成本比较大，需要多方人员协作讨论业务模型。</li>
<li>迭代快的小系统不如直接使用 MVC 做好代码规范能够更快地上线。</li>
</ul>
<p><strong>因此，不适配 DDD 的系统是什么呢？</strong></p>
<ul>
<li>中小规模的系统，本身业务体量小，功能单一，选择 MVC 架构无疑是最好的。</li>
<li>项目化交付的系统，研发周期短，一天到晚按照甲方的需求定制功能（这种本身业务需求边界就不清晰，功能的可持续迭代性就很差，而且这种系统一般就是一口价买卖），这种也最好选择 MVC。</li>
</ul>
<p>那相反地，适配 DDD 的系统是什么呢？<strong>中大规模系统，产品化模式，业务可持续迭代，可预见的业务逻辑复杂性的系统。</strong></p>
<p>总而言之就是：</p>
<ul>
<li>你还不了解 DDD 或者你们系统功能简单，就选择 MVC；</li>
<li>你不知道选用什么技术架构做开发，处于业务探索阶段，选用 MVC；</li>
<li>其他时候就酌情考虑 DDD。</li>
</ul>
<h2>五、总结</h2>
<p>这一讲我们以大多数 Java 开发工作者使用 MVC 过程中可能踩到的坑出发，对比分析介绍了 DDD 如何使用其核心思想来解决信息不对称、业务边界不清晰、祖传代码维护性差等问题，这样可以让你对 DDD 有一个粗略的认知，明白它与 MVC 架构的区别，以及它的主要优势在哪儿。</p>
<p>当然，DDD 绝对不是一个完美的应用架构，相比较 MVC 架构，它的理论概念与使用上要复杂很多。因此，如果你的系统不是一个中大型的、且可持续迭代的复杂业务系统，我还是建议使用 MVC 进行开发，利用好方法的抽象功能即可。</p>
<p>好了，在这一讲的学习过程中，如果你遇到什么问题或者有好的经验要分享，欢迎你在留言区与我分享，我们一起交流，一起进步。</p></div>
</body></html>